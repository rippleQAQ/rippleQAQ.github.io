<!DOCTYPE html>
<html lang="en">
    <head>
  <!-- 元数据 -->
  <meta charset="utf-8">
  
  
  <title>HGAME 2022 Week1 writeup by ripple | ripple</title>
  <meta name="author" content="rippleQAQ" />
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="robots" content="index,follow" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <meta name="format-detection" content="telphone=no, email=no" />
  
    <meta name="keywords" content="" />
  
  <meta name="description" content="HGAME 2022 Week1 writeup by rippleREVERSE初学逆向QAQ里面的代码不是很好，这次学到了很多新东东。 test your IDAIDA测试，把程序放入IDA反汇编F5查看伪代码即可得到结果。  flag:hgame{te5t_y0ur_IDA} easyasm汇编真是一点不懂啊，这题其实是摸出来的QAQ。 附件是txt文件，里面是汇编代码，读程序。 12345">
<meta property="og:type" content="article">
<meta property="og:title" content="HGAME 2022 Week1 writeup by ripple">
<meta property="og:url" content="https://rippleqaq.github.io/2023/02/08/HGAME-Week1/index.html">
<meta property="og:site_name" content="ripple">
<meta property="og:description" content="HGAME 2022 Week1 writeup by rippleREVERSE初学逆向QAQ里面的代码不是很好，这次学到了很多新东东。 test your IDAIDA测试，把程序放入IDA反汇编F5查看伪代码即可得到结果。  flag:hgame{te5t_y0ur_IDA} easyasm汇编真是一点不懂啊，这题其实是摸出来的QAQ。 附件是txt文件，里面是汇编代码，读程序。 12345">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/test_your_IDA.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/enc.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/tea.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/key.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/key2.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/question.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/code.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/Res.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/suoyin.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/mota.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/f12NB.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/fakeflag.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/cookie.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/trueflag.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/hint.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/whoiam.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/upload.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/success.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/connect.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/getshell.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/where.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/rar.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/truerar.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/gps.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/truegps.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/lsb.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/steghide.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/wh.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/getpq.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/study.jpg">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/decode.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/hellopwn.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/catflag.png">
<meta property="article:published_time" content="2023-02-07T16:00:00.000Z">
<meta property="article:modified_time" content="2023-08-02T05:05:43.699Z">
<meta property="article:author" content="rippleQAQ">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://rippleqaq.github.io/static/HGAME-Week1/test_your_IDA.png">
  
  <!-- 站点验证相关 -->
  
    
    
    
  
  <!-- 样式表文件 -->
  <link rel="stylesheet" id="kratos-css" href="/css/kratosr.min.css" media="all"></script>
  
    <link rel="stylesheet" id="darkmode-css" href="/css/kr-color-dark.min.css" media="(prefers-color-scheme: dark)"></script>
    <script src="/js/kr-dark.min.js"></script>
  
  
    <link rel="stylesheet" id="highlight-css" href="/css/highlight/night-eighties.min.css" media="all"></script>
  
  
  <link rel="stylesheet" id="fontawe-css" href="/vendors/font-awesome@4.7.0/css/font-awesome.min.css" media="all"></script>
  <link rel="stylesheet" id="nprogress-css" href="/vendors/nprogress@0.2.0/nprogress.css" media="all"></script>
  
  
    <link rel="stylesheet" href="/vendors/aplayer@1.10.1/dist/APlayer.min.css"></script>
  
  
    <link rel="stylesheet" href="/vendors/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"></script>
  
  <!-- 不得不预先加载的一些JS文件 -->
  <script src="/vendors/jquery@3.6.0/dist/jquery.min.js"></script>
  
    <script src="/vendors/qrcode_js@1.0.0/qrcode.min.js"></script>
  
  
  <style>
    
      .kratos-cover.kratos-cover-2 {
        background-image: url('/images/banner.webp');
      }
    
    
      @media(min-width:768px) {
        body.custom-background {
          background-image: url('/images/bg.webp');
        }
      }
    
  </style>
  
<meta name="generator" content="Hexo 5.4.2"></head>


    <body class="custom-background">
        <div id="kratos-wrapper">
    <div id="kratos-page">
        <div id="kratos-header">
            <header id="kratos-desktop-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="nav-header">
                        <nav id="kratos-menu-wrap">
                            <ul id="kratos-primary-menu" class="sf-menu">
                                
                                    
                                    
                                
                            </ul>
                        </nav>
                    </div>
                </div>
            </header>
            <header id="kratos-mobile-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="color-logo"><a href="/">ripple</a></div>
                    <div class="nav-toggle">
                        <a class="kratos-nav-toggle js-kratos-nav-toggle">
                            <i></i>
                        </a>
                    </div>
                </div>
            </header>
        </div>
        <div class="kratos-start kratos-hero-2">
            <!-- <div class="kratos-overlay"></div> -->
            <div class="kratos-cover kratos-cover-2 text-center">
                <div class="desc desc2 animate-box">
                    <a href="/">
                        <h2>ripple</h2> <br />
                        <span></span>
                    </a>
                </div>
            </div>
        </div>

        <div id="kratos-blog-post">
            <div class="container">
                <div id="main" class="row">
                    

        

            <section class="col-md-8">

        

            <article itemscope itemtype="https://schema.org/Article">
    
    <link itemprop="mainEntityOfPage" href="https://rippleqaq.github.io/2023/02/08/HGAME-Week1/">
    <div class="kratos-hentry kratos-post-inner clearfix">
        <header class="kratos-entry-header">
            
                <h1 class="kratos-entry-title text-center" itemprop="name headline">HGAME 2022 Week1 writeup by ripple</h1>
            
            
            <ul class="kratos-post-meta text-center">
                <li><time datetime="2023-02-07T16:00:00.000Z" itemprop="datePublished"><i class="fa fa-calendar"></i> 2023-02-08</time></li>
                <li itemprop="author" itemscope itemtype="https://schema.org/Person">
                    <i class="fa fa-user"></i> 作者 <span itemprop="name">rippleQAQ</span>
                </li>
                <li>
                    <i class="fa fa-edit"></i> 
                    
                    
                        ~16.22K
                    
                    字
                </li>
                
            </ul>
        </header>
        <div class="kratos-post-content">
            
            <div id="expire-alert" class="alert alert-warning hidden" role="alert">
                <div class="icon"><i class="fa fa-warning"></i></div>
                <div class="text"><p>本文最后编辑于 <time datetime="1690952743699"></time> 前，其中的内容可能需要更新。</p></div>
            </div>
            
            
            
                <div class="kratos-post-inner-toc toc-div-class" >
                    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#HGAME-2022-Week1-writeup-by-ripple"><span class="toc-number">1.</span> <span class="toc-text">HGAME 2022 Week1 writeup by ripple</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#REVERSE"><span class="toc-number">1.1.</span> <span class="toc-text">REVERSE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#test-your-IDA"><span class="toc-number">1.1.1.</span> <span class="toc-text">test your IDA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easyasm"><span class="toc-number">1.1.2.</span> <span class="toc-text">easyasm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easyenc"><span class="toc-number">1.1.3.</span> <span class="toc-text">easyenc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#a-cup-of-tea"><span class="toc-number">1.1.4.</span> <span class="toc-text">a_cup_of_tea</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#encode"><span class="toc-number">1.1.5.</span> <span class="toc-text">encode</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB"><span class="toc-number">1.2.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Classic-Childhood-Game"><span class="toc-number">1.2.1.</span> <span class="toc-text">Classic Childhood Game</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Become-A-Member"><span class="toc-number">1.2.2.</span> <span class="toc-text">Become A Member</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Guess-Who-I-Am"><span class="toc-number">1.2.3.</span> <span class="toc-text">Guess Who I Am</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Show-Me-Your-Beauty"><span class="toc-number">1.2.4.</span> <span class="toc-text">Show Me Your Beauty</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-number">1.3.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Sign-In"><span class="toc-number">1.3.1.</span> <span class="toc-text">Sign In</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Where-am-I"><span class="toc-number">1.3.2.</span> <span class="toc-text">Where am I</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A5%9E%E7%A7%98%E7%9A%84%E6%B5%B7%E6%8A%A5"><span class="toc-number">1.3.3.</span> <span class="toc-text">神秘的海报</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#e99p1ant-want-girlfriend"><span class="toc-number">1.3.4.</span> <span class="toc-text">e99p1ant_want_girlfriend</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CRYPTO"><span class="toc-number">1.4.</span> <span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA"><span class="toc-number">1.4.1.</span> <span class="toc-text">RSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Be-Stream"><span class="toc-number">1.4.2.</span> <span class="toc-text">Be Stream</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A5%9E%E7%A7%98%E7%9A%84%E7%94%B5%E8%AF%9D"><span class="toc-number">1.4.3.</span> <span class="toc-text">神秘的电话</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pwn"><span class="toc-number">1.5.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#test-nc"><span class="toc-number">1.5.1.</span> <span class="toc-text">test_nc</span></a></li></ol></li></ol></li></ol>
                </div>
            
            <hr />
            <div itemprop="articleBody"><h1 id="HGAME-2022-Week1-writeup-by-ripple"><a href="#HGAME-2022-Week1-writeup-by-ripple" class="headerlink" title="HGAME 2022 Week1 writeup by ripple"></a>HGAME 2022 Week1 writeup by ripple</h1><h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><p>初学逆向QAQ里面的代码不是很好，这次学到了很多新东东。</p>
<h3 id="test-your-IDA"><a href="#test-your-IDA" class="headerlink" title="test your IDA"></a>test your IDA</h3><p>IDA测试，把程序放入IDA反汇编F5查看伪代码即可得到结果。</p>
<p><img src="/static/HGAME-Week1/test_your_IDA.png"></p>
<p>flag:hgame{te5t_y0ur_IDA}</p>
<h3 id="easyasm"><a href="#easyasm" class="headerlink" title="easyasm"></a>easyasm</h3><p>汇编真是一点不懂啊，这题其实是摸出来的QAQ。</p>
<p>附件是txt文件，里面是汇编代码，读程序。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">; void __cdecl enc(char *p)</span><br><span class="line">.text:00401160 _enc            proc near               ; CODE XREF: _main+1B↑p</span><br><span class="line">.text:00401160</span><br><span class="line">.text:00401160 i               = dword ptr -4</span><br><span class="line">.text:00401160 Str             = dword ptr  8</span><br><span class="line">.text:00401160</span><br><span class="line">.text:00401160                 push    ebp</span><br><span class="line">.text:00401161                 mov     ebp, esp</span><br><span class="line">.text:00401163                 push    ecx</span><br><span class="line">.text:00401164                 mov     [ebp+i], 0</span><br><span class="line">.text:0040116B                 jmp     short loc_401176</span><br><span class="line">.text:0040116D ; ---------------------------------------------------------------------------</span><br><span class="line">.text:0040116D</span><br><span class="line">.text:0040116D loc_40116D:                             ; CODE XREF: _enc+3B↓j</span><br><span class="line">.text:0040116D                 mov     eax, [ebp+i]</span><br><span class="line">.text:00401170                 add     eax, 1</span><br><span class="line">.text:00401173                 mov     [ebp+i], eax</span><br><span class="line">.text:00401176</span><br><span class="line">.text:00401176 loc_401176:                             ; CODE XREF: _enc+B↑j</span><br><span class="line">.text:00401176                 mov     ecx, [ebp+Str]</span><br><span class="line">.text:00401179                 push    ecx             ; Str</span><br><span class="line">.text:0040117A                 call    _strlen</span><br><span class="line">.text:0040117F                 add     esp, 4</span><br><span class="line">.text:00401182                 cmp     [ebp+i], eax</span><br><span class="line">.text:00401185                 jge     short loc_40119D</span><br><span class="line">.text:00401187                 mov     edx, [ebp+Str]</span><br><span class="line">.text:0040118A                 add     edx, [ebp+i]</span><br><span class="line">.text:0040118D                 movsx   eax, byte ptr [edx]</span><br><span class="line">.text:00401190                 xor     eax, 33h</span><br><span class="line">.text:00401193                 mov     ecx, [ebp+Str]</span><br><span class="line">.text:00401196                 add     ecx, [ebp+i]</span><br><span class="line">.text:00401199                 mov     [ecx], al</span><br><span class="line">.text:0040119B                 jmp     short loc_40116D</span><br><span class="line">.text:0040119D ; ---------------------------------------------------------------------------</span><br><span class="line">.text:0040119D</span><br><span class="line">.text:0040119D loc_40119D:                             ; CODE XREF: _enc+25↑j</span><br><span class="line">.text:0040119D                 mov     esp, ebp</span><br><span class="line">.text:0040119F                 pop     ebp</span><br><span class="line">.text:004011A0                 retn</span><br><span class="line">.text:004011A0 _enc            endp</span><br><span class="line">Input: your flag</span><br><span class="line">Encrypted result: 0x5b,0x54,0x52,0x5e,0x56,0x48,0x44,0x56,0x5f,0x50,0x3,0x5e,0x56,0x6c,0x47,0x3,0x6c,0x41,0x56,0x6c,0x44,0x5c,0x41,0x2,0x57,0x12,0x4e</span><br></pre></td></tr></table></figure>

<p>一开始还是想正经挑战的，看《汇编语言》看到mov那吧，再看看这个，还是一脸懵逼。</p>
<p>于是就开始摸了。</p>
<p>总之就是看到这一行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.text:00401190                 xor     eax, 33h</span><br></pre></td></tr></table></figure>

<p>想着既然给的是汇编，程序应该不会太复杂，于是就试了试异或0x33回去看看，没想到摸对了。</p>
<p>附上解密代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">char</span> ch[] = &#123; <span class="number">0x5b</span>,<span class="number">0x54</span>,<span class="number">0x52</span>,<span class="number">0x5e</span>,<span class="number">0x56</span>,<span class="number">0x48</span>,<span class="number">0x44</span>,<span class="number">0x56</span>,<span class="number">0x5f</span>,<span class="number">0x50</span>,<span class="number">0x3</span>,<span class="number">0x5e</span>,<span class="number">0x56</span>,<span class="number">0x6c</span>,<span class="number">0x47</span>,<span class="number">0x3</span>,<span class="number">0x6c</span>,<span class="number">0x41</span>,<span class="number">0x56</span>,<span class="number">0x6c</span>,<span class="number">0x44</span>,<span class="number">0x5c</span>,<span class="number">0x41</span>,<span class="number">0x2</span>,<span class="number">0x57</span>,<span class="number">0x12</span>,<span class="number">0x4e</span> ,<span class="string">&#x27;\0&#x27;</span> &#125;;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(ch); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, ch[i] ^ <span class="number">0x33</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>flag:hgame{welc0me_t0_re_wor1d!}</p>
<h3 id="easyenc"><a href="#easyenc" class="headerlink" title="easyenc"></a>easyenc</h3><p>拖到IDA中查看</p>
<p>主要加密函数：</p>
<p><img src="/static/HGAME-Week1/enc.png"></p>
<p>异或0x32后减去86，逆过来就是先加86然后异或0x32。</p>
<p>然后找到密文是v7[10]数组和v8，这里一开始不明白怎么成int了，后来了解到是编译优化，编译后为了加快数据的初始化速度就4字节一初始化，原来v7是个char数组。</p>
<p>可以试试对着v7后面的数据及v8按H变成16进制就一目了然了。</p>
<p>我这里麻烦了，其实小段存进去v7已经排好了，代码如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> v7[<span class="number">10</span>];</span><br><span class="line">	v7[<span class="number">0</span>] = <span class="number">0x9FDFF04</span>;</span><br><span class="line">	v7[<span class="number">1</span>] = <span class="number">0xB0F301</span>;</span><br><span class="line">	v7[<span class="number">2</span>] = <span class="number">0xADF00500</span>;</span><br><span class="line">	v7[<span class="number">3</span>] = <span class="number">0x5170607</span>;</span><br><span class="line">	v7[<span class="number">4</span>] = <span class="number">0x17FD17EB</span>;</span><br><span class="line">	v7[<span class="number">5</span>] = <span class="number">0x1EE01EA</span>;</span><br><span class="line">	v7[<span class="number">6</span>] = <span class="number">0xFA05B1EA</span>;</span><br><span class="line">	v7[<span class="number">7</span>] = <span class="number">0xAC170108</span>;</span><br><span class="line">	v7[<span class="number">8</span>] = <span class="number">0xFDEA01EC</span>;</span><br><span class="line">	v7[<span class="number">9</span>] = <span class="number">0x60705F0</span>;</span><br><span class="line">	<span class="type">char</span> v8 = <span class="number">0xF9</span>;</span><br><span class="line">	<span class="type">char</span> ch[<span class="number">41</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">char</span>* p = v7;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">40</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		ch[i] = (*p);</span><br><span class="line">		p++;</span><br><span class="line">	&#125;</span><br><span class="line">	ch[<span class="number">40</span>] = v8;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">41</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, (v7[i] + <span class="number">86</span>)^<span class="number">0x32</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>flag:hgame{4ddit1on_is_a_rever5ible_0peration}</p>
<h3 id="a-cup-of-tea"><a href="#a-cup-of-tea" class="headerlink" title="a_cup_of_tea"></a>a_cup_of_tea</h3><p>考察TEA加密算法</p>
<p>关键是找到delta,key,密文</p>
<p>这里的密文很好得出，就是Buf2，由于是编译优化（编译后为了加快数据的初始化速度就4字节一初始化），我这里依然是用了不太好的方法，算法有待改进。</p>
<p><img src="/static/HGAME-Week1/tea.png" alt="tea"></p>
<p>看得出来sub_7FF7EDDD10B4是TEA的加密函数，进入找到v3 -= 0x543210DD，但这里要注意delta不是0x543210DD，因为TEA加密是无符号整型+=delta，所以这里的delta是-0x543210DD所对应的无符号整型。</p>
<p><img src="/static/HGAME-Week1/key.png"></p>
<p>key我是通过调试找到的，在加密函数内打断点看v2、v4、v5、v6记下来。</p>
<p>其实也可以直接找到xmmword_7FF7EDDD22B0提取</p>
<p><img src="/static/HGAME-Week1/key2.png"></p>
<p>然后就是解密了。</p>
<p>一开始蠢了看到这+2真的自己加2了</p>
<p>input被转成了unsigned int*，每次加减1相当于加减4字节。所以其实是8。</p>
<p><img src="/static/HGAME-Week1/question.png"></p>
<p>而且更重要是<strong>tea加密单次加密8字节，逆向要充分遵照原文，加密怎么加密的就怎么解密，1个字节都不能差。</strong></p>
<p>最后附上有待优化的代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span><span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], i;  <span class="comment">/* set up */</span></span><br><span class="line">    <span class="type">uint32_t</span> delta = (<span class="type">unsigned</span> <span class="type">int</span>) - <span class="number">0x543210DD</span>, sum = delta * <span class="number">32</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">    <span class="type">uint32_t</span> k0 = k[<span class="number">0</span>], k1 = k[<span class="number">1</span>], k2 = k[<span class="number">2</span>], k3 = k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;                         <span class="comment">/* basic cycle start */</span></span><br><span class="line">        v1 -= ((v0 &lt;&lt; <span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k3);</span><br><span class="line">        v0 -= ((v1 &lt;&lt; <span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k1);</span><br><span class="line">        sum -= delta;</span><br><span class="line">    &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">    v[<span class="number">0</span>] = v0; v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span>* argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> key[<span class="number">4</span>] = &#123;<span class="number">0x12345678</span>,<span class="number">0x23456789</span>,<span class="number">0x34567890</span>,<span class="number">0x45678901</span>&#125;;<span class="comment">//key</span></span><br><span class="line">	<span class="type">int</span> Buf2[<span class="number">8</span>];</span><br><span class="line">	Buf2[<span class="number">0</span>] = <span class="number">778273437</span>;</span><br><span class="line">	Buf2[<span class="number">1</span>] = <span class="number">-1051836401</span>;</span><br><span class="line">	Buf2[<span class="number">2</span>] = <span class="number">-1690714183</span>;</span><br><span class="line">	Buf2[<span class="number">3</span>] = <span class="number">1512016660</span>;</span><br><span class="line">	Buf2[<span class="number">4</span>] = <span class="number">1636330974</span>;</span><br><span class="line">	Buf2[<span class="number">5</span>] = <span class="number">1701168847</span>;</span><br><span class="line">	Buf2[<span class="number">6</span>] = <span class="number">-1626976412</span>;</span><br><span class="line">	Buf2[<span class="number">7</span>] = <span class="number">594166774</span>;</span><br><span class="line">	<span class="type">int</span> v8 = <span class="number">0x7D6B</span>;</span><br><span class="line">	<span class="type">char</span> ch[<span class="number">35</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">char</span>* p = Buf2;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		ch[i] = (*p);</span><br><span class="line">		p++;</span><br><span class="line">	&#125;</span><br><span class="line">	ch[<span class="number">32</span>] = <span class="number">0x6b</span>;</span><br><span class="line">	ch[<span class="number">33</span>] = <span class="number">0x7d</span>;</span><br><span class="line">    decrypt(ch, key);</span><br><span class="line">    decrypt(ch + <span class="number">8</span>, key);</span><br><span class="line">    decrypt(ch + <span class="number">16</span>, key);</span><br><span class="line">    decrypt(ch + <span class="number">24</span>, key);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,ch);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>flag:hgame{Tea_15_4_v3ry_h3a1thy_drlnk}</p>
<h3 id="encode"><a href="#encode" class="headerlink" title="encode"></a>encode</h3><p>die查壳是32位</p>
<p>用32位IDA打开</p>
<p><img src="/static/HGAME-Week1/code.png"></p>
<p>分析加密的过程:</p>
<p>v4是密文，偶数位存的是左四位二进制的值，奇数位存的是右四位二进制的值。</p>
<p>dword_403000是密文，进入后shift+8设为数组，shift+E提取。</p>
<p>发现识别为了char。</p>
<p>我这里比较手动，把多余的0x00替换掉了之后再放入。</p>
<p>以及后面的flag也是自己一个一个输入，中间还出错了，总之非常人工，又慢又不准确。</p>
<p>后来才知道可以用移位操作符QAQ。</p>
<p>总之别看我这的代码了，看别人的吧，丢人。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> m[] =</span><br><span class="line">	&#123;</span><br><span class="line">	  <span class="number">0x08</span>, <span class="number">0x06</span>, <span class="number">0x07</span>, <span class="number">0x06</span>, <span class="number">0x01</span>, <span class="number">0x06</span>, <span class="number">0x0D</span>, <span class="number">0x06</span>, <span class="number">0x05</span>, <span class="number">0x06</span>,</span><br><span class="line">	  <span class="number">0x0B</span>, <span class="number">0x07</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x0E</span>, <span class="number">0x06</span>, <span class="number">0x03</span>, <span class="number">0x06</span>, <span class="number">0x0F</span>, <span class="number">0x06</span>,</span><br><span class="line">	  <span class="number">0x04</span>, <span class="number">0x06</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x0F</span>, <span class="number">0x05</span>, <span class="number">0x09</span>, <span class="number">0x06</span>, <span class="number">0x03</span>, <span class="number">0x07</span>,</span><br><span class="line">	  <span class="number">0x0F</span>, <span class="number">0x05</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x01</span>, <span class="number">0x06</span>, <span class="number">0x03</span>, <span class="number">0x07</span>, <span class="number">0x09</span>, <span class="number">0x07</span>,</span><br><span class="line">	  <span class="number">0x0F</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x06</span>, <span class="number">0x0F</span>, <span class="number">0x06</span>, <span class="number">0x02</span>, <span class="number">0x07</span>, <span class="number">0x0F</span>, <span class="number">0x05</span>,  </span><br><span class="line">	  <span class="number">0x01</span>, <span class="number">0x06</span>, <span class="number">0x0F</span>, <span class="number">0x05</span>, <span class="number">0x02</span>, <span class="number">0x07</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x06</span>, <span class="number">0x07</span>,</span><br><span class="line">	  <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x02</span>, <span class="number">0x07</span>, <span class="number">0x03</span>, <span class="number">0x07</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x0F</span>, <span class="number">0x05</span>,</span><br><span class="line">	  <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x0E</span>, <span class="number">0x06</span>, <span class="number">0x07</span>, <span class="number">0x06</span>, <span class="number">0x09</span>, <span class="number">0x06</span>, <span class="number">0x0E</span>, <span class="number">0x06</span>,</span><br><span class="line">	  <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x02</span>, <span class="number">0x07</span>, <span class="number">0x0D</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">	  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span></span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="type">char</span> flag[] =</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="number">0x68</span>,<span class="number">0x67</span>,<span class="number">0x61</span>,<span class="number">0x6d</span>,<span class="number">0x65</span>,<span class="number">0x7b</span>,<span class="number">0x65</span>,<span class="number">0x6e</span>,<span class="number">0x63</span>,<span class="number">0x6f</span>,</span><br><span class="line">		<span class="number">0x64</span>,<span class="number">0x65</span>,<span class="number">0x5f</span>,<span class="number">0x69</span>,<span class="number">0x73</span>,<span class="number">0x5f</span>,<span class="number">0x65</span>,<span class="number">0x61</span>,<span class="number">0x73</span>,<span class="number">0x79</span>,</span><br><span class="line">		<span class="number">0x5f</span>,<span class="number">0x66</span>,<span class="number">0x6f</span>,<span class="number">0x72</span>,<span class="number">0x5f</span>,<span class="number">0x61</span>,<span class="number">0x5f</span>,<span class="number">0x72</span>,<span class="number">0x65</span>,<span class="number">0x76</span>,</span><br><span class="line">		<span class="number">0x65</span>,<span class="number">0x72</span>,<span class="number">0x73</span>,<span class="number">0x65</span>,<span class="number">0x5f</span>,<span class="number">0x65</span>,<span class="number">0x6e</span>,<span class="number">0x67</span>,<span class="number">0x69</span>,<span class="number">0x6e</span>,</span><br><span class="line">		<span class="number">0x65</span>,<span class="number">0x65</span>,<span class="number">0x72</span>,<span class="number">0x7d</span>,<span class="number">0x00</span></span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, flag);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>flag:hgame{encode_is_easy_for_a_reverse_engineer}</p>
<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="Classic-Childhood-Game"><a href="#Classic-Childhood-Game" class="headerlink" title="Classic Childhood Game"></a>Classic Childhood Game</h3><p>经典魔塔，interesting，但我不太会玩哈哈哈哈哈。</p>
<p>之前有段时间热衷于魔塔，有个玩h5魔塔的网站分享一下：<a target="_blank" rel="noopener" href="https://h5mota.com/">HTML5魔塔广场 (h5mota.com)</a></p>
<p>言归正传，用F12查看源代码的时候发现/Res路径</p>
<p><img src="/static/HGAME-Week1/Res.png"></p>
<p>访问/Res路径发现是一个资源索引</p>
<p><img src="/static/HGAME-Week1/suoyin.png"></p>
<p>里面存在js代码的泄露</p>
<p>逐个查看，可以在events.js文件里发现不对劲，发现mota()函数</p>
<p><img src="/static/HGAME-Week1/mota.png"></p>
<p>了解到代码被混淆过，可读性较差。</p>
<p>一开始蠢蠢的去找了一个在线运行js代码的<a target="_blank" rel="noopener" href="https://www.sojson.com/runjs.html">网站</a>把mota{}去掉运行出来找到了flag(这个网站好像还可以解密混淆过的js代码，总之先贴一下)</p>
<p>后来才知道原来可以F12在控制台直接运行QAQ</p>
<p><img src="/static/HGAME-Week1/f12NB.png"></p>
<p>flag:hgame{fUnnyJavascript&amp;FunnyM0taG4me}</p>
<p>看了源代码里的内容，感觉里面有好多彩蛋嘿嘿。</p>
<h3 id="Become-A-Member"><a href="#Become-A-Member" class="headerlink" title="Become A Member"></a>Become A Member</h3><p>由题目描述可知是一个HTTP请求头的题目。</p>
<p>一开始乱玩访问/flag没想到找到一个假flag哈哈哈哈哈，这都能被预判吗。</p>
<p><img src="/static/HGAME-Week1/fakeflag.png"></p>
<p>用BurpSuite拦截后抓包，右键send to repeater。</p>
<p><strong>第一个提示是：请先提供一下身份证明（Cute-Bunny）哦</strong></p>
<p>查了一下最后发现是User-Agent:</p>
<p>改User-Agent为Cute-Bunny后send</p>
<p>得到<strong>第二个提示：每一个能够成为会员的顾客们都应该持有名为Vidar的邀请码（code）</strong></p>
<p>从返回头中我们能看到给了一个cookie里是code</p>
<p><img src="/static/HGAME-Week1/cookie.png"></p>
<p>不难想到添加Cookie</p>
<p>添加Cookie: code=Vidar后send</p>
<p>得到<strong>第三个提示：由于特殊原因，我们只接收来自于bunnybunnybunny.com的会员资格申请</strong></p>
<p>显然是用Referer头来修改请求来源</p>
<p>添加Referer: bunnybunnybunny.com后send</p>
<p>得到<strong>第四个提示：就差最后一个本地的请求，就能拿到会员账号啦</strong></p>
<p>本地请求这里可以用X-Forwarded-For伪造本地访问</p>
<p>添加X-Forwarded-For: 127.0.0.1后send</p>
<p>得到<strong>第五个提示：username:luckytoday password:happy123（请以json请求方式登陆）</strong></p>
<p>在这里卡了好久，去了解了json格式之后以为只能用POST方法传，后来才知道是可以用GET方法传json格式数据，同时还要注意这里值都是字符串！</p>
<p>在最后空一行后添加：</p>
<p>{“username”:”luckytoday”,”password”:”happy123”}</p>
<p>然后send</p>
<p>得到<strong>flag:hgame{H0w_ArE_Y0u_T0day?}</strong></p>
<p><img src="/static/HGAME-Week1/trueflag.png"></p>
<p>最后附上完整报文：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">GET / HTTP/1.1</span><br><span class="line">Host: week-1.hgame.lwsec.cn:30768</span><br><span class="line">User-Agent: Cute-Bunny</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line">Referer: bunnybunnybunny.com</span><br><span class="line">Cookie: code=Vidar</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Content-Length: 47</span><br><span class="line"></span><br><span class="line">&#123;&quot;username&quot;:&quot;luckytoday&quot;,&quot;password&quot;:&quot;happy123&quot;&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Guess-Who-I-Am"><a href="#Guess-Who-I-Am" class="headerlink" title="Guess Who I Am"></a>Guess Who I Am</h3><p>一只不会写脚本的菜狗路过QAQ</p>
<p>题目提示写个脚本帮助兔兔，可是我不会啊QAQ</p>
<p>只能自己亲自来一个个帮兔兔答了QAQ</p>
<p>网站F12查看源代码发现提示：</p>
<p><img src="/static/HGAME-Week1/hint.png"></p>
<p>访问后其实就是问题的答案</p>
<p>因为不会脚本就保存到记事本里查找复制粘贴了QAQ</p>
<p>还好学长亚萨西，只是100个，来个1000甚至10000个就很难受了QAQ</p>
<p>附上即将成功的画面QAQ：</p>
<p><img src="/static/HGAME-Week1/whoiam.png"></p>
<p>最后flag是：hgame{Guess_who_i_am^Happy_Crawler}</p>
<p><strong>认识了学长学姐，这波赚了(</strong></p>
<h3 id="Show-Me-Your-Beauty"><a href="#Show-Me-Your-Beauty" class="headerlink" title="Show Me Your Beauty"></a>Show Me Your Beauty</h3><p>第一次做文件上传题，下中国蚁剑弄了半天，写个一句话木马windows直接报毒删了233</p>
<p>后来下了火绒来查毒就OK了。成功后现在看到一个网站能传文件就想传个木马试试了（×bushi</p>
<p>总之在过程中学到了许多。</p>
<p>网站可以上传图片格式的文件。</p>
<p>写了一个一句话木马1.php：&lt;?php@eval($_POST[“cmd”]);?&gt;很经典</p>
<p>然后将后缀改为.jpg格式</p>
<p>打开BurpSuite拦截请求后上传文件1.jpg点submit后BurpSuite就会拦截到请求头</p>
<p><img src="/static/HGAME-Week1/upload.png"></p>
<p>将其中的Content-Disposition里的filename从1.jpg改为1.Php(注意有一个大写)</p>
<p>一开始是改为1.php提示类型不匹配，应该是将.php后缀禁了，于是换成了.Php</p>
<p>然后关闭拦截，提示上传成功且告知了位置</p>
<p><img src="/static/HGAME-Week1/success.png"></p>
<p>当我们访问/img/1.Php时是一个空白页面而不是404页面，说明木马已成功植入网站。</p>
<p>接着用蚁剑连接就行了。</p>
<p><img src="/static/HGAME-Week1/connect.png"></p>
<p>在根目录下找到flag:hgame{Unsave_F1L5_SYS7em_UPL0ad!}</p>
<p><img src="/static/HGAME-Week1/getshell.png"></p>
<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="Sign-In"><a href="#Sign-In" class="headerlink" title="Sign In"></a>Sign In</h3><p>签到题，base64解码得到flag:hgame{Welcome_To_HGAME2023!}</p>
<h3 id="Where-am-I"><a href="#Where-am-I" class="headerlink" title="Where am I"></a>Where am I</h3><p>是一个流量包文件，题目里的提示是上传了文件到网盘。</p>
<p>wireshark打开查找http，得到两个数据。</p>
<p><img src="/static/HGAME-Week1/where.png"></p>
<p>在其中一个找到rar文件。</p>
<p>导出数据，找到rar文件头和文件尾，用16进制编辑器手动分离一下，得到一个rar的压缩包，命名为1.rar</p>
<p>可以无脑binwalk分离出来rar，但我这样分离出来的文件尾是不对的，还要再分，不知道这样能不能继续进行。</p>
<p>总之是得到了一个rar文件，查看后提示文件头损坏并显示有加密。</p>
<p><img src="/static/HGAME-Week1/rar.png"></p>
<p>于是猜测是rar的伪加密，可参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_42172261/article/details/100760375">网站</a>。</p>
<p>将第24位的数据从24改为20，重命名为11.rar，就可正常解压得到Exchangeable.jpg</p>
<p><img src="/static/HGAME-Week1/truerar.png"></p>
<p>题目是要找到拍摄的经纬度，右键查看Exchangeable.jpg的属性就行了</p>
<p><img src="/static/HGAME-Week1/gps.png"></p>
<p>南纬北纬西经东经的话可以试一下也很方便。或者我们用PS来来看：</p>
<p>PS打开Exchangeable.jpg，在文件-文件简介中查看。</p>
<p><img src="/static/HGAME-Week1/truegps.png"></p>
<p>这样就知道flag啦：hgame{116_24_1488_E_39_54_5418_N}</p>
<h3 id="神秘的海报"><a href="#神秘的海报" class="headerlink" title="神秘的海报"></a>神秘的海报</h3><p>附件为png图片，是LSB隐写。用StegSolve打开Analyze-Data Extract中查看，颜色通道都选0。</p>
<p><img src="/static/HGAME-Week1/lsb.png"></p>
<p>保存一下，得到一半的flag:hgame{U_ Kn0w_LSB&amp;W</p>
<p>另一半的flag提示在<a target="_blank" rel="noopener" href="https://drive.google.com/file/d/13kBos3Ixlfwkf3e0z0kJTEqBxm7RUk-G/view?usp=sharing">https://drive.google.com/file/d/13kBos3Ixlfwkf3e0z0kJTEqBxm7RUk-G/view?usp=sharing</a>  </p>
<p>下载，是一首歌曲且用了Steghide加密，密码提示是一个六位整数。</p>
<p>下载得到Bossanova.wav</p>
<p>用Steghide解密，密码是最经典的123456，试一下就得到了（或者可以爆破？）</p>
<p><img src="/static/HGAME-Week1/steghide.png"></p>
<p>在同目录下找到flag2.txt得到另一半flag:av^Mp3_Stego}</p>
<p>总的flag:hgame{U_ Kn0w_LSB&amp;Wav^Mp3_Stego}</p>
<h3 id="e99p1ant-want-girlfriend"><a href="#e99p1ant-want-girlfriend" class="headerlink" title="e99p1ant_want_girlfriend"></a>e99p1ant_want_girlfriend</h3><p>茄皇NB，我要是女生我就冲了[doge]。</p>
<p>得到一张帅气的照片，题目提示CRC有问题，不难猜出是修改了宽高。</p>
<p>用脚本爆破出宽高（<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_61554462/article/details/123599109">采用的脚本</a>）</p>
<p>得到原宽高0x200 0x2c2</p>
<p>16进制编译器打开将00 00 02 A8 改为 00 00 02 C2后保存即可。</p>
<p><img src="/static/HGAME-Week1/wh.png"></p>
<p>在图片下方得到flag:hgame{e99p1ant_want_a_girlfriend_qq_524306184}</p>
<p>QQ直接加爆23333333</p>
<h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h3><p>基本的RSA加密，已知e、n、c。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n=p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c=<span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n=<span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">c=110674792674017748243232351185896019660434718342001686906527789876264976328686134101972125493938434992787002915562500475480693297360867681000092725583284616353543422388489208114545007138606543678040798651836027433383282177081034151589935024292017207209056829250152219183518400364871109559825679273502274955582</span></span><br><span class="line"><span class="string">n=135127138348299757374196447062640858416920350098320099993115949719051354213545596643216739555453946196078110834726375475981791223069451364024181952818056802089567064926510294124594174478123216516600368334763849206942942824711531334239106807454086389211139153023662266125937481669520771879355089997671125020789</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>一开始用iroot开方求p、q发现不行。</p>
<p>后来才知道p、q差太大时时不能这么算的。</p>
<p>要利用网站进行n的分解。</p>
<p>分解网站：<a target="_blank" rel="noopener" href="http://www.factordb.com/">factordb.com</a></p>
<p><img src="/static/HGAME-Week1/getpq.png"></p>
<p>然后用脚本就行了。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = <span class="number">110674792674017748243232351185896019660434718342001686906527789876264976328686134101972125493938434992787002915562500475480693297360867681000092725583284616353543422388489208114545007138606543678040798651836027433383282177081034151589935024292017207209056829250152219183518400364871109559825679273502274955582</span></span><br><span class="line">n = <span class="number">135127138348299757374196447062640858416920350098320099993115949719051354213545596643216739555453946196078110834726375475981791223069451364024181952818056802089567064926510294124594174478123216516600368334763849206942942824711531334239106807454086389211139153023662266125937481669520771879355089997671125020789</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">q = <span class="number">11239134987804993586763559028187245057652550219515201768644770733869088185320740938450178816138394844329723311433549899499795775655921261664087997097294813</span></span><br><span class="line">p = <span class="number">12022912661420941592569751731802639375088427463430162252113082619617837010913002515450223656942836378041122163833359097910935638423464006252814266959128953</span></span><br><span class="line"></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<p>flag:hgame{factordb.com_is_strong!}</p>
<p>由答案也可以看出是考察利用网站来大数分解。</p>
<h3 id="Be-Stream"><a href="#Be-Stream" class="headerlink" title="Be Stream"></a>Be Stream</h3><p>原加密过程：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">type</span>(flag) == <span class="built_in">bytes</span></span><br><span class="line"></span><br><span class="line">key = [<span class="built_in">int</span>.from_bytes(<span class="string">b&quot;Be water&quot;</span>, <span class="string">&#x27;big&#x27;</span>), <span class="built_in">int</span>.from_bytes(<span class="string">b&quot;my friend&quot;</span>, <span class="string">&#x27;big&#x27;</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">stream</span>(<span class="params">i</span>):</span><br><span class="line">    <span class="keyword">if</span> i==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> key[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">elif</span> i==<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> key[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> (stream(i-<span class="number">2</span>)*<span class="number">7</span> + stream(i-<span class="number">1</span>)*<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">enc = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    water = stream((i//<span class="number">2</span>)**<span class="number">6</span>) % <span class="number">256</span></span><br><span class="line">    enc += <span class="built_in">bytes</span>([water ^ flag[i]])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(enc)</span><br><span class="line"><span class="comment"># b&#x27;\x1a\x15\x05\t\x17\t\xf5\xa2-\x06\xec\xed\x01-\xc7\xcc2\x1eXA\x1c\x157[\x06\x13/!-\x0b\xd4\x91-\x06\x8b\xd4-\x1e+*\x15-pm\x1f\x17\x1bY&#x27;</span></span><br></pre></td></tr></table></figure>



<p>是一道算法优化的题目，折磨了几天做出来了。下提供两种做法：</p>
<p><strong>1.改递归为循环，多取几次mod</strong></p>
<p>严谨说明不是很会，总之就是取mod不影响结果，也可以感受一下。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="built_in">int</span>.from_bytes(<span class="string">b&quot;Be water&quot;</span>, <span class="string">&#x27;big&#x27;</span>), <span class="built_in">int</span>.from_bytes(<span class="string">b&quot;my friend&quot;</span>, <span class="string">&#x27;big&#x27;</span>)]</span><br><span class="line">flag = <span class="string">b&quot;&quot;</span></span><br><span class="line">enc = <span class="string">b&#x27;\x1a\x15\x05\t\x17\t\xf5\xa2-\x06\xec\xed\x01-\xc7\xcc2\x1eXA\x1c\x157[\x06\x13/!-\x0b\xd4\x91-\x06\x8b\xd4-\x1e+*\x15-pm\x1f\x17\x1bY&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">stream</span>(<span class="params">i</span>):</span><br><span class="line">    pre = key[<span class="number">0</span>]</span><br><span class="line">    nex = key[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> key[<span class="number">0</span>] % <span class="number">256</span></span><br><span class="line">    <span class="keyword">elif</span> i == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> key[<span class="number">1</span>] % <span class="number">256</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">while</span>(i &gt; <span class="number">1</span>):</span><br><span class="line">            ret = ((pre % <span class="number">256</span>) * <span class="number">7</span> + (nex % <span class="number">256</span>) * <span class="number">4</span>) % <span class="number">256</span></span><br><span class="line">            pre = nex</span><br><span class="line">            nex = ret</span><br><span class="line">            i -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> ret % <span class="number">256</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    water = stream((i//<span class="number">2</span>) * (i//<span class="number">2</span>) % <span class="number">256</span> * (i//<span class="number">2</span>) % <span class="number">256</span>*(i//<span class="number">2</span>) % <span class="number">256</span>*(i//<span class="number">2</span>) % <span class="number">256</span>*(i//<span class="number">2</span>) % <span class="number">256</span>) % <span class="number">256</span></span><br><span class="line">    flag += <span class="built_in">bytes</span>([water ^ enc[i]])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>



<p><strong>2.斐波那契矩阵和矩阵快速幂</strong></p>
<p>去网上查了查相关资料，学过线代知道矩阵后比较好理解。</p>
<p>学习参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/NYIST_TC_LYQ/article/details/52981353">矩阵快速幂求斐波那契数列</a>。</p>
<p>算法改造自<a target="_blank" rel="noopener" href="https://blog.csdn.net/Cowry5/article/details/89416468">斐波那契第n项的几种解法</a>以及tr0uble学长的指点。</p>
<p>这里就算一下初始的矩阵（一开始顺序反了导致错了QAQ）</p>
<p><img src="/static/HGAME-Week1/study.jpg"></p>
<p>按照自己理解写的，哪里不对请指出QAQ</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="built_in">int</span>.from_bytes(<span class="string">b&quot;Be water&quot;</span>, <span class="string">&#x27;big&#x27;</span>), <span class="built_in">int</span>.from_bytes(<span class="string">b&quot;my friend&quot;</span>, <span class="string">&#x27;big&#x27;</span>)]</span><br><span class="line">flag = <span class="string">b&quot;&quot;</span></span><br><span class="line">enc = <span class="string">b&#x27;\x1a\x15\x05\t\x17\t\xf5\xa2-\x06\xec\xed\x01-\xc7\xcc2\x1eXA\x1c\x157[\x06\x13/!-\x0b\xd4\x91-\x06\x8b\xd4-\x1e+*\x15-pm\x1f\x17\x1bY&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">a, b</span>):  <span class="comment"># 首先定义二阶矩阵乘法运算</span></span><br><span class="line">    c = [[<span class="number">0</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">0</span>]]  <span class="comment"># 定义一个空的二阶矩阵，存储结果</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):  <span class="comment"># row</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):  <span class="comment"># col</span></span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):  <span class="comment"># 新二阶矩阵的值计算</span></span><br><span class="line">                c[i][j] += a[i][k] * b[k][j] % <span class="number">256</span></span><br><span class="line">                c[i][j] % <span class="number">256</span></span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">F5</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>: <span class="keyword">return</span> key[<span class="number">0</span>] % <span class="number">256</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>: <span class="keyword">return</span> key[<span class="number">1</span>] % <span class="number">256</span></span><br><span class="line">    res = [[<span class="number">1</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">1</span>]]  <span class="comment"># 单位矩阵，等价于1</span></span><br><span class="line">    A = [[<span class="number">4</span>, <span class="number">7</span>], [<span class="number">1</span>, <span class="number">0</span>]]  <span class="comment"># A矩阵</span></span><br><span class="line">    <span class="keyword">while</span> n:</span><br><span class="line">        <span class="keyword">if</span> n &amp; <span class="number">1</span>: res = mul(A, res)  <span class="comment"># 如果n是奇数，或者直到n=1停止条件</span></span><br><span class="line">        A = mul(A, A) <span class="comment"># 快速幂</span></span><br><span class="line">        n &gt;&gt;= <span class="number">1</span>  <span class="comment"># 整除2，向下取整</span></span><br><span class="line">    <span class="keyword">return</span> (res[<span class="number">1</span>][<span class="number">0</span>] * key[<span class="number">1</span>] + res[<span class="number">1</span>][<span class="number">1</span>] * key[<span class="number">0</span>]) % <span class="number">256</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    water = F5(((i//<span class="number">2</span>)**<span class="number">6</span>))</span><br><span class="line">    flag += <span class="built_in">bytes</span>([water ^ enc[i]])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>flag:hgame{1f_this_ch@l|eng3_take_y0u_to0_long_time?}</p>
<p>确实take了我三天QAQ。</p>
<h3 id="神秘的电话"><a href="#神秘的电话" class="headerlink" title="神秘的电话"></a>神秘的电话</h3><p>考察古典加密</p>
<p>最后北欧神话有点难想到233</p>
<p>附加里是：encrypted_message.txt和morse.wav</p>
<p>encrypted_message.txt是base64编码，解码得到重要信息：</p>
<p>几个星期前，我们收到一个神秘的消息。但是这个消息被重重加密，我们不知道它的真正含义是什么。唯一知道的信息是关于密钥的：“<strong>只有倒着翻过十八层的篱笆才能抵达北欧神话的终点</strong>”。</p>
<p>morse.wav是摩斯密码，我是用Audacity打开看手动转为电码：</p>
<p>—–/..—/..—/…–/./..–.-/.–./.-./../../-…/.-../-.–/..–.-/..–.-/…./—/-./.–/.-/..–.-/.—/–/–./…./..–.-/..-./–./-.-/-.-./–.-/.-/—/–.-/-/–/..-./.-./</p>
<p>解密是在<a target="_blank" rel="noopener" href="http://www.all-tool.cn/Tools/morse/?&rand=b3fec0934ef63922ca23c02175d1fadd">摩斯电码转换</a></p>
<p>解密得到：0223E_PRIIBLY__HONWA_JMGH_FGKCQAOQTMFR</p>
<p>题目说了最后套上hgame{}且均为小写，转换一下为小写</p>
<p>0223e_priibly__honwa_jmgh_fgkcqaoqtmfr</p>
<p>接下来就是根据提示了：只有<strong>倒着</strong>翻过<strong>十八层的篱笆</strong>才能抵达<strong>北欧神话</strong>的终点</p>
<p>分别对应为：<strong>逆序</strong>、<strong>18为一组的栅栏</strong>、<strong>以Vidar为密钥的维吉尼亚</strong></p>
<p>前两个好想，最后的北欧神话是Vidar-Team名字的由来，可以去<a target="_blank" rel="noopener" href="https://vidar.club/">官网</a>了解。</p>
<p>最后就用<a target="_blank" rel="noopener" href="https://gchq.github.io/CyberChef/">CyberChef</a>来演示：</p>
<p><img src="/static/HGAME-Week1/decode.png"></p>
<p>flag:hgame{welcome_to_hgame2023_and_enjoy_hacking}</p>
<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="test-nc"><a href="#test-nc" class="headerlink" title="test_nc"></a>test_nc</h3><p>测试远程连接用233</p>
<p>IDA打开vuln，很直接，我喜欢。</p>
<p><img src="/static/HGAME-Week1/hellopwn.png"></p>
<p>用ubuntu远程连接cat flag就行了。</p>
<p><img src="/static/HGAME-Week1/catflag.png"></p>
<p>week1就有点折磨到了，week2QAQQAQQAQQAQQAQQAQQAQQAQ</p>
</div>
        </div>
        
            <div class="kratos-copyright text-center clearfix">
                <h5 itemprop="copyrightNotice">本作品采用 <a rel="license nofollow" target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">知识共享署名-相同方式共享 4.0 国际许可协议</a> 进行许可</h5>
            </div>
        
        <footer class="kratos-entry-footer clearfix">
            
                <div class="post-like-donate text-center clearfix" id="post-like-donate">
                
                
                    <a class="share" href="javascript:;"><i class="fa fa-share-alt"></i> 分享</a>
                    <div class="share-wrap" style="display: none;">
    <div class="share-group">
        <a href="javascript:;" class="share-plain qq" onclick="share('qq');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-qq"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain qzone" onclick="share('qzone');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-star"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain weixin pop style-plain" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-weixin"></i>
            </div>
            <div class="share-int">
                <div class="qrcode" id="wechat-qr"></div>
                <p>打开微信“扫一扫”，打开网页后点击屏幕右上角分享按钮</p>
            </div>
        </a>
        <a href="javascript:;" class="share-plain weibo" onclick="share('weibo');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-weibo"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain facebook style-plain" onclick="share('facebook');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-facebook"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain twitter style-plain" onclick="share('twitter');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-twitter"></i>
            </div>
        </a>
    </div>
    <script type="text/javascript">
        $(()=>{
            new QRCode("wechat-qr", {
                text: "https://rippleqaq.github.io/2023/02/08/HGAME-Week1/",
                width: 150,
                height: 150,
                correctLevel : QRCode.CorrectLevel.H
            });
        });
        function share(dest) {
            const qqBase        = "https://connect.qq.com/widget/shareqq/index.html?";
            const weiboBase     = "https://service.weibo.com/share/share.php?";
            const qzoneBase     = "https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?";
            const facebookBase  = "https://www.facebook.com/sharer/sharer.php?";
            const twitterBase   = "https://twitter.com/intent/tweet?";
            const hostUrl       = "https://rippleqaq.github.io/2023/02/08/HGAME-Week1/";
            const title         = "「HGAME 2022 Week1 writeup by ripple」";
            const excerpt       = `HGAME 2022 Week1 writeup by rippleREVERSE初学逆向QAQ里面的代码不是很好，这次学到了很多新东东。
test your IDAIDA测试，把程序放入IDA反汇编F5查看伪代码即可得到结果。

f...`;
            let _URL;
            switch (dest) {
                case "qq"       : _URL = qqBase+"url="+hostUrl+"&title="+title+"&desc=&summary="+excerpt+"&site=cxpy";     break;
                case "weibo"    : _URL = weiboBase+"url="+hostUrl+"&title="+title+excerpt;                                 break;
                case "qzone"    : _URL = qzoneBase+"url="+hostUrl+"&title="+title+"&desc=&summary="+excerpt+"&site=cxpy";  break;
                case "facebook" : _URL = facebookBase+"u="+hostUrl;                                                        break;
                case "twitter"  : _URL = twitterBase+"text="+title+excerpt+"&url="+hostUrl;                                break;
            }
            window.open(_URL);
        };
    </script>
</div>
                
                </div>
            
            <div class="footer-tag clearfix">
                <div class="pull-left">
                <i class="fa fa-tags"></i>
                    
                </div>
                <div class="pull-date">
                    <time datetime="2023-08-02T05:05:43.699Z" itemprop="dateModified">最后编辑：2023-08-02</time>
                </div>
            </div>
        </footer>
    </div>
    
        <nav class="navigation post-navigation clearfix" role="navigation">
            
            <div class="nav-previous clearfix">
                <a title=" HGAME 2022 Week4 writeup by ripple" href="/2023/02/03/HGAME-Week4/">&lt; 上一篇</a>
            </div>
            
            
            <div class="nav-next clearfix">
                <a title=" HGAME 2022 Week2 writeup by ripple" href="/2023/02/24/HGAME-Week2/">下一篇 &gt;</a>
            </div>
            
        </nav>
    
    
</article>

        

            </section>

        

                
            

<section id="kratos-widget-area" class="col-md-4 hidden-xs hidden-sm">
    <!-- 文章和页面根据splitter来分割，没有的话就从头开始设置为sticky -->
    
    
                <aside id="krw-about" class="widget widget-kratos-about clearfix">
    <div class="photo-background"></div>
    <div class="photo-wrapper clearfix">
        <div class="photo-wrapper-tip text-center">
            <img class="about-photo" src="/static/1.jpg" loading="lazy" decoding="auto" />
        </div>
    </div>
    <div class="textwidget">
        <p class="text-center"></p>
    </div>
    <div class="site-meta">
        <a class="meta-item" href="/archives/">
            <span class="title">
                文章
            </span>
            <span class="count">
                17
            </span>
        </a>
        <a class="meta-item" href="/categories/">
            <span class="title">
                分类
            </span>
            <span class="count">
                5
            </span>
        </a>
        <a class="meta-item" href="/tags/">
            <span class="title">
                标签
            </span>
            <span class="count">
                0
            </span>
        </a>
    </div>
</aside>
            
                    <div class="sticky-area">
                
                    <aside id="krw-toc" class="widget widget-kratos-toc clearfix toc-div-class" >
    <div class="photo-background"></div>
    <h4 class="widget-title no-after">
        <i class="fa fa-compass"></i>
        文章目录
        <span class="toc-progress-bar" role="progressbar" aria-label="阅读进度："></span>
    </h4>
    <div class="textwidget">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#HGAME-2022-Week1-writeup-by-ripple"><span class="toc-text">HGAME 2022 Week1 writeup by ripple</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#REVERSE"><span class="toc-text">REVERSE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#test-your-IDA"><span class="toc-text">test your IDA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easyasm"><span class="toc-text">easyasm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easyenc"><span class="toc-text">easyenc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#a-cup-of-tea"><span class="toc-text">a_cup_of_tea</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#encode"><span class="toc-text">encode</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB"><span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Classic-Childhood-Game"><span class="toc-text">Classic Childhood Game</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Become-A-Member"><span class="toc-text">Become A Member</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Guess-Who-I-Am"><span class="toc-text">Guess Who I Am</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Show-Me-Your-Beauty"><span class="toc-text">Show Me Your Beauty</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Sign-In"><span class="toc-text">Sign In</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Where-am-I"><span class="toc-text">Where am I</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A5%9E%E7%A7%98%E7%9A%84%E6%B5%B7%E6%8A%A5"><span class="toc-text">神秘的海报</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#e99p1ant-want-girlfriend"><span class="toc-text">e99p1ant_want_girlfriend</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CRYPTO"><span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA"><span class="toc-text">RSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Be-Stream"><span class="toc-text">Be Stream</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A5%9E%E7%A7%98%E7%9A%84%E7%94%B5%E8%AF%9D"><span class="toc-text">神秘的电话</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pwn"><span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#test-nc"><span class="toc-text">test_nc</span></a></li></ol></li></ol></li></ol>
    </div>
</aside>
                
                
  <aside id="krw-categories" class="widget widget-kratos-categories clearfix">
    <h4 class="widget-title"><i class="fa fa-folder"></i>分类目录</h4>
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CTF/">CTF</a><span class="category-list-count">6</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/CTF/match/">match</a><span class="category-list-count">6</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/blog/">blog</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/flask/">flask</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><span class="category-list-count">2</span></li></ul>
  </aside>


            
                
            
                
  <aside id="krw-posts" class="widget widget-kratos-posts">
  <h4 class="widget-title"><i class="fa fa-file"></i>最新文章</h4>
  <div class="tab-content">
      <ul class="list-group">
        
        
          
          
            <a class="list-group-item" href="/2023/09/21/blog_demain_deploy/"><i class="fa  fa-book"></i> 为博客设置个人域名</a>
            
          
        
          
          
            <a class="list-group-item" href="/2023/09/21/123/test/"><i class="fa  fa-book"></i> 123123</a>
            
          
        
          
          
            <a class="list-group-item" href="/2023/04/04/flask_variable/"><i class="fa  fa-book"></i> flask路由与视图映射与传参规则</a>
            
          
        
          
          
            <a class="list-group-item" href="/2023/03/11/HGAME-Final/"><i class="fa  fa-book"></i> HGAME 2022 FINAL writeup by ripple</a>
            
          
        
          
          
            <a class="list-group-item" href="/2023/03/09/build_environment/"><i class="fa  fa-book"></i> linux内基本环境搭建</a>
            
          
        
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
      </ul>
  </div>
  </aside>

            
    </div>
</section>
        
        </div>
    </div>
</div>
<footer>
    <div id="footer"  class="ap-lrc"  >
        <div class="container">
            <div class="row">
                <div class="col-md-6 col-md-offset-3 footer-list text-center">
                    <ul class="kratos-social-icons">
                        
                        
                        <li><a target="_blank" rel="nofollow" href="https://t.me/CandyUnion"><i class="fa fa-telegram"></i></a></li>
                        
                        
                        
                        <li><a target="_blank" rel="me" href="https://nya.one/@rippleQAQ"><i class="fa fa fa-share-alt-square"></i></a></li>
                        <li><a target="_blank" rel="nofollow" href="https://github.com/rippleQAQ"><i class="fa fa-github"></i></a></li>
                        
                    </ul>
                    <ul class="kratos-copyright">
                        <div>
                            <li>&copy; 2023 ripple 版权所有.</li>
                            <li>本站已运行<span id="span_dt">Loading...</span></li>
                        </div>
                        <div>
                            <li>Theme <a href="https://github.com/Candinya/Kratos-Rebirth" target="_blank">Kratos:Rebirth</a></li>
                            <li>Site built with&nbsp;<i class="fa fa-heart throb" style="color:#d43f57"></i>&nbsp;by rippleQAQ.</li>
                        </div>
                        <div>
                            <li>Powered by <a href="https://hexo.io" target="_blank" rel="nofollow">Hexo</a></li>
                            <li>Hosted on <a href="https://github.io" target="_blank">Github Pages</a></li>
                        </div>
                        <div>
                            
                            
                        </div>
                    </ul>
                </div>
            </div>
        </div>
        <div class="kr-tool text-center">
            <div class="tool">
                
                    <div class="box search-box">
                        <a href="/search/">
                            <span class="fa fa-search"></span>
                        </a>
                    </div>
                
                
                    <div class="box theme-box" id="darkmode-switch">
                        <span class="fa fa-adjust"></span>
                    </div>
                
                
            </div>
            <div class="box gotop-box">
                <span class="fa fa-chevron-up"></span>
            </div>
        </div>
    </div>
</footer>
</div>
</div>

        <script defer src="/vendors/bootstrap@3.3.4/dist/js/bootstrap.min.js"></script>
<script defer src="/vendors/nprogress@0.2.0/nprogress.js"></script>
<script>
    if (!window.kr) {
        window.kr = {};
    }
    window.kr.notMobile = (!(navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)));
    window.kr.siteRoot = "/";
</script>


    <script async src="/js/candy.min.js"></script>



    <script defer src="/vendors/aplayer@1.10.1/dist/APlayer.min.js"></script>
    
    <script defer src="/vendors/meting@2.0.1/dist/Meting.min.js"></script>
    <meting-js
        server="netease"
        type="playlist"
        id="3204190542"
        order="random"
        fixed="true"
    >
    </meting-js>



    <script defer src="/vendors/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

<script defer src="/vendors/clipboard@2.0.6/dist/clipboard.min.js"></script>
<script defer src="/js/kratosr.min.js"></script>
<script defer src="/js/pjax.min.js"></script>



<!-- Extra support for third-party plguins  -->


    </body>
</html>